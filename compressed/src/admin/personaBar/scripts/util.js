"use strict";define(["jquery"],function($){var initializedModules={};return{init:function(config){var loadTempl;return loadTempl=function(template,wrapper,params,self,cb,isMobile){var callbackInit,templateSuffix,cssSuffix,initMethod,moduleJs,loadMethod;if(initializedModules[template]){if(moduleJs=initializedModules[template],"function"!=typeof moduleJs.load)return;loadMethod=isMobile?"loadMobile":"load","Class"===moduleJs.type?moduleJs.load(moduleJs,params,isMobile,cb):moduleJs[loadMethod].call(moduleJs,params,cb)}else{templateSuffix=isMobile?".mobi.html":".html",cssSuffix=isMobile?".mobi.css":".css",initMethod=isMobile?"initMobile":"init";var requiredArray=["../"+template,"text!../../"+template+templateSuffix];requiredArray.push("css!../../css/"+template+cssSuffix),window.require(requiredArray,function(module,html){void 0!==module&&(wrapper.css("visibility","hidden").html(html),callbackInit=function(wrapper,cb){wrapper.css("visibility","visible"),"function"==typeof cb&&cb()},"Class"===module.type?initializedModules[template]=new module(wrapper,self,params,isMobile,callbackInit(wrapper)):(module[initMethod].call(module,wrapper,self,params,callbackInit(wrapper,cb)),initializedModules[template]=module))})}},{loadTemplate:function(template,wrapper,params,cb){var self=this;loadTempl(template,wrapper,params,self,cb,!1)},loadMobileTemplate:function(template,wrapper,params,cb){var self=this;loadTempl(template,wrapper,params,self,cb,!0)},loadInContextAnalytics:function(template,wrapper,cb){var self=this,params={moduleName:config.socialModule,showEngageStats:config.socialModule&&config.isCommunityManager};loadTempl(template,wrapper,params,self,cb,!1)},loadResx:function(cb){var self=this,timeStampKey="PersonaBarResxTimeStamp."+config.culture,resxKey="PersonaBarResx."+config.culture,localStorageAllowed=function(){var mod="DNN_localStorageTEST";try{return window.localStorage.setItem(mod,mod),window.localStorage.removeItem(mod),!0}catch(e){return!1}}();if(localStorageAllowed&&config.resxTimeStamp)if(window.localStorage[timeStampKey]===config.resxTimeStamp){var t=window.localStorage[resxKey];if(t)return self.resx=JSON.parse(t),void("function"==typeof cb&&cb())}else window.localStorage.removeItem(timeStampKey),window.localStorage.removeItem(resxKey);self.sf.moduleRoot="dnncorp/personaBar",self.sf.controller="localization",self.sf.getsilence("gettable",{culture:config.culture},function(d){try{localStorageAllowed&&(window.localStorage[timeStampKey]=config.resxTimeStamp,window.localStorage[resxKey]=JSON.stringify(d))}catch(ex){"QuotaExceededError"===ex.name&&console.log("Local Storage might be full."),console.log(ex),window.localStorage[timeStampKey]&&window.localStorage.removeItem(timeStampKey),window.localStorage[resxKey]&&window.localStorage.removeItem(resxKey)}self.resx=d,"function"==typeof cb&&cb()})},getModuleNameByParams:function(params){return params?params.moduleName||"":""},asyncParallel:function(deferreds,callback){var i=deferreds.length;0===i&&callback();var call=function(){i--,0===i&&callback()};$.each(deferreds,function(ii,d){d(call)})},asyncWaterfall:function(deferreds,callback){var call=function(){var deferred=deferreds.shift();return deferred?void deferred(call):void callback()};call()},confirm:function(text,confirmBtn,cancelBtn,confirmHandler,cancelHandler){$("#confirmation-dialog > p").html(text),$("#confirmation-dialog a#confirmbtn").html(confirmBtn).unbind("click").bind("click",function(){"function"==typeof confirmHandler&&confirmHandler.apply(),$("#confirmation-dialog").fadeOut(200,"linear",function(){$("#mask").hide()})}),$("#confirmation-dialog a#cancelbtn").html(cancelBtn).unbind("click").bind("click",function(){"function"==typeof cancelHandler&&cancelHandler.apply(),$("#confirmation-dialog").fadeOut(200,"linear",function(){$("#mask").hide()})}),$("#mask").show(),$("#confirmation-dialog").fadeIn(200,"linear"),$(window).off("keydown.confirmDialog").on("keydown.confirmDialog",function(evt){27===evt.keyCode&&($(window).off("keydown.confirmDialog"),$("#confirmation-dialog a#cancelbtn").trigger("click"))})},notify:function(text){$("#notification-dialog > p").removeClass().html(text),$("#notification-dialog").fadeIn(200,"linear",function(){setTimeout(function(){$("#notification-dialog").fadeOut(200,"linear")},2e3)})},notifyError:function(text){$("#notification-dialog > p").removeClass().addClass("errorMessage").html(text),$("#notification-dialog").fadeIn(200,"linear",function(){setTimeout(function(){$("#notification-dialog").fadeOut(200,"linear")},2e3)})},localizeErrMessages:function(validator){var self=this;validator.errorMessages={required:self.resx.PersonaBar.err_Required,minLength:self.resx.PersonaBar.err_Minimum,number:self.resx.PersonaBar.err_Number,nonNegativeNumber:self.resx.PersonaBar.err_NonNegativeNumber,positiveNumber:self.resx.PersonaBar.err_PositiveNumber,nonDecimalNumber:self.resx.PersonaBar.err_NonDecimalNumber,email:self.resx.PersonaBar.err_Email}},trimContentToFit:function(content,width){if(!content||!width)return"";var charWidth=8.5,max=Math.floor(width/charWidth),arr=content.split(" "),trimmed="",count=0;return $.each(arr,function(i,v){return count+=v.length,count<max?(trimmed&&(trimmed+=" "),trimmed+=v,count++,void 0):(trimmed+="...",!1)}),trimmed},deserializeCustomDate:function(str){if(this.moment)return this.moment(str,"YYYY-MM-DD").toDate()},serializeCustomDate:function(dateObj){if(this.moment)return this.moment(dateObj).format("YYYY-MM-DD")},ONE_THOUSAND:1e3,ONE_MILLION:1e6,formatAbbreviateBigNumbers:function(number){var suffix,size=number;if(size>=this.ONE_MILLION)size/=this.ONE_MILLION,suffix=this.resx.PersonaBar.label_OneMillionSufix;else{if(!(size>=this.ONE_THOUSAND))return this.formatCommaSeparate(size);size/=this.ONE_THOUSAND,suffix=this.resx.PersonaBar.label_OneThousandSufix}return this.formatCommaSeparate(size.toFixed(1))+" "+suffix},formatCommaSeparate:function(number){for(;/(\d+)(\d{3})/.test(number.toString());)number=number.toString().replace(/(\d+)(\d{3})/,"$1,$2");return number},secondsFormatter:function(seconds){var oneHour=3600,format=seconds>=oneHour?"H:mm:ss":"mm:ss";return moment().startOf("day").add(seconds,"seconds").format(format)}}}}}),define("css",{load:function(name,require,load,config){function inject(filename){var head=document.getElementsByTagName("head")[0],link=document.createElement("link");link.href=filename,link.rel="stylesheet",link.type="text/css",head.appendChild(link)}var path=name;for(var i in config.paths)if(0==path.indexOf(i)){path=path.replace(i,config.paths[i]);break}path.indexOf("://")==-1&&(path=config.baseUrl+path),inject(path+"?"+config.urlArgs),load(!0)},pluginBuilder:"./css-build"});