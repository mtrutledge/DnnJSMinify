define(["jquery","knockout","jquery-ui.min","css!../css/personaBarDialog.css"],function($,ko){var PersonaBarDialogClass;return PersonaBarDialogClass=function(){"use strict";function PersonaBarDialog(options,htmlForPannels,koObserveCallback,afterBindCallback){return PersonaBarDialog.active?void console.log("PersonaBarDialog already opened"):(PersonaBarDialog.active=!0,options||(options={inObject:$(document.body),animation:!0,width:650,title:"Notice",innerTitle:"",showAcceptBtn:!0,acceptBtnLbl:"Accept",showCancelBtn:!0,cancelBtnLbl:"Cancel",onAcceptCallback:null,beforeCloseCallback:null,onCloseCallback:null,closeOnAccept:!0}),_options=options,options.width||(_options.width=650),options.title||(_options.title="Notice"),options.inObject||(_options.inObject=$(document.body)),options.innerTitle||(_options.innerTitle=""),options.acceptBtnLbl||(_options.acceptBtnLbl="Accept"),options.showAcceptBtn!==!1&&(_options.showAcceptBtn=!0),options.cancelBtnLbl||(_options.cancelBtnLbl="Cancel"),options.showCancelBtn!==!1&&(_options.showCancelBtn=!0),options.animation!==!1&&(_options.animation=!0),options.closeOnAccept!==!1&&(_options.closeOnAccept=!0),_viewModel={},htmlForPannels||(htmlForPannels=""),addDialog(),void setTimeout(function(){initDialog();var personaBarDialog=$(".personaBarDialog");personaBarDialog.width(_options.width),htmlForPannels&&personaBarDialog.find(".panels").prepend(htmlForPannels),setTimeout(function(){applyBindings("function"==typeof koObserveCallback?koObserveCallback():void 0),setTimeout(function(){"function"==typeof afterBindCallback&&afterBindCallback()},0),showDialog()},0)},0))}var _options,_html,_viewModel,_personaBarDialogMask,_personaBarDialog,_originalHeight,_top,_win,addDialog,applyBindings,closeDialog,acceptDialog,initDialog,showDialog,updateHeight;return PersonaBarDialog.class="PersonaBarDialog",PersonaBarDialog.type="Class",PersonaBarDialog.active=!1,_html='<div class="personaBarDialogMask" style="display:none;"></div>                <div class="personaBarDialog" style="display:none;">                    <div class="container">                        <div class="title dialogTitle">                            <span class="title" data-bind="html: title"></span>                            <span class="btn-close" data-bind="click: closeDialog"></span>                        </div>                        <div class="content">                            <div class="title" data-bind="html: innerTitle"></div>                            <div class="panels" data-bind="with: dialogHTML"></div>                        </div>                    </div>                    <div class="actions">                      <span class="btn btn-accept" data-bind="visible: showAcceptBtn, text: acceptBtnLbl, click: acceptDialog"></span>                      <span class="btn btn-cancel" data-bind="visible: showCancelBtn, text: cancelBtnLbl, click: closeDialog"></span>                    </div>                </div>',_options=null,_viewModel=null,_personaBarDialog=null,_personaBarDialogMask=null,applyBindings=function(viewModel){setTimeout(function(){_viewModel={dialogHTML:"",title:ko.observable(_options.title),innerTitle:ko.observable(_options.innerTitle),acceptBtnLbl:ko.observable(_options.acceptBtnLbl),showAcceptBtn:ko.observable(_options.showAcceptBtn),cancelBtnLbl:ko.observable(_options.cancelBtnLbl),showCancelBtn:ko.observable(_options.showCancelBtn),acceptDialog:acceptDialog,closeDialog:closeDialog,enableAccept:ko.observable(!0)},"object"==typeof viewModel&&(_viewModel.dialogHTML=viewModel,viewModel.enableAcceptForDialog&&(_viewModel.enableAccept=viewModel.enableAcceptForDialog)),ko.applyBindings(_viewModel,_personaBarDialog[0])},0)},addDialog=function(){return $("body").prepend(_html)},closeDialog=function(){var node;_win&&_win.off(".personaBarDialog"),_personaBarDialog&&_personaBarDialog.off("DOMMouseScroll mousewheel"),node=$(".personaBarDialog"),"function"==typeof _options.beforeCloseCallback&&_options.beforeCloseCallback(),node.length>0&&ko.cleanNode($(".personaBarDialog")[0]),_options.inObject.height(_originalHeight),_personaBarDialog.remove(),_personaBarDialogMask.remove(),"function"==typeof _options.onCloseCallback&&_options.onCloseCallback(),PersonaBarDialog.active=!1},acceptDialog=function(){("boolean"!=typeof _viewModel.enableAccept||_viewModel.enableAccept)&&("function"!=typeof _viewModel.enableAccept||_viewModel.enableAccept())&&("function"==typeof _options.onAcceptCallback&&_options.onAcceptCallback(),_options.closeOnAccept===!0&&closeDialog())},initDialog=function(){var doc,bottom,left,top;_win=$(window),doc=$(document),_personaBarDialogMask=$(".personaBarDialogMask"),_personaBarDialog=$(".personaBarDialog"),_personaBarDialog.draggable({handle:".dialogTitle",cursor:"move"}),left="-"+Math.round(_options.width/2)+"px",top=100+doc.scrollTop()+"px",bottom="40px",_personaBarDialog.css({top:top,"margin-left":left,"margin-bottom":bottom}),_personaBarDialogMask.css({height:doc.height()+_personaBarDialog.height()}),setTimeout(function(){_top=doc.scrollTop(),_personaBarDialogMask.css({"min-height":doc.scrollTop()+_personaBarDialog.height()+100+"px"})},0),_win.off("scroll.personaBarDialog").on("scroll.personaBarDialog",function(){doc.scrollTop()<_top&&doc.scrollTop(_top)}),_win.off("keydown.personaBarDialog").on("keydown.personaBarDialog",function(evt){27===evt.keyCode&&closeDialog()}),_personaBarDialog.off("DOMMouseScroll mousewheel").on("DOMMouseScroll mousewheel",function(evt){var self,scrollTop,scrollHeight,height,delta,up,prevent;return self=$(this),scrollTop=this.scrollTop,scrollHeight=this.scrollHeight,height=self.height(),delta=evt.originalEvent.wheelDelta,up=delta>0,prevent=function(){return evt.stopPropagation(),evt.preventDefault(),evt.returnValue=!1,!1},!up&&-delta>scrollHeight-height-scrollTop?(self.scrollTop(scrollHeight),prevent()):up&&delta>scrollTop?(self.scrollTop(0),prevent()):void 0})},showDialog=function(){_personaBarDialogMask.show(),_options.animation?_personaBarDialog.fadeIn(100):_personaBarDialog.show()},updateHeight=function(){_personaBarDialogMask.css({"min-height":$(document).scrollTop()+_personaBarDialog.height()+400+"px"})},PersonaBarDialog.prototype.updateHeight=updateHeight,PersonaBarDialog.prototype.close=closeDialog,PersonaBarDialog}()});