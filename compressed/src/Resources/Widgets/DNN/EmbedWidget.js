DotNetNuke.UI.WebControls.Widgets.EmbedWidget=function(widget){DotNetNuke.UI.WebControls.Widgets.EmbedWidget.initializeBase(this,[widget]),this._type="Unknown",this._multiValueDelimiter=";",this._publisher="",this._attributes=[]},DotNetNuke.UI.WebControls.Widgets.EmbedWidget.prototype={render:function(){var params=this._widget.childNodes;this._attributes.widgetid=this._widget.id;for(var p=0;p<params.length;p++)try{var paramName=params[p].name.toLowerCase();switch(paramName){case"type":this._type=params[p].value;break;case"multivaluedelimiter":this._multiValueDelimiter=params[p].value;break;case"publisher":this._publisher=params[p].value;break;default:this._attributes[paramName]=params[p].value}}catch(e){}var self=this,folder=this._type.indexOf(".")>-1?this._type.split(".")[0]:this._type,path=$dnn.baseResourcesUrl+"Widgets/DNN/EmbedWidgetResources/"+folder+"/"+this._type.toLowerCase()+".snippet.htm";""!=this._publisher&&(path=$dnn.baseResourcesUrl+"Widgets/User/"+this._publisher+"/EmbedWidgetResources/"+folder+"/"+this._type.toLowerCase()+".snippet.htm"),$.get(path,function(data){self._internalRender(self._type,self._multiValueDelimiter,data)})},_internalRender:function(type,delim,data){var re=/{\s*(\S+?)\s*:(.*?):(.*?)}/gi,matches=data.match(re);if(null!=matches)for(var m=0;m<matches.length;m++){var match=matches[m].replace(re,"$1 | $2 | $3").split("|"),attr=match[0].trim(),valuePresent=match[1].trim();if(null!=this._attributes[attr])for(var attrValues=this._attributes[attr].split(delim),v=0;v<attrValues.length;v++)valuePresent=valuePresent.replaceAll("{"+v+"}",attrValues[v]);var valueMissing=match[2].trim();data=data.replace(matches[m],null!=this._attributes[attr]?valuePresent:valueMissing)}re=/<script.*?>((\n|\r|.)*?)<\/script>/gi;var scripts=[],scriptMatches=data.match(re);if(null!=scriptMatches)for(var m=0;m<scriptMatches.length;m++)scripts[scripts.length]=scriptMatches[m].replace(re,"$1"),data=data.replace(scriptMatches[m],"");if(null!=this._attributes.elementId&&""!=this._attributes.elementId){$get(this._attributes.elementId).innerHTML=data;var span=document.createElement("span");DotNetNuke.UI.WebControls.Widgets.EmbedWidget.callBaseMethod(this,"render",[span]),DotNetNuke.UI.WebControls.Widgets.appendDynamicScripts(this._attributes.elementId,scripts)}else{var div=document.createElement("div");DotNetNuke.UI.WebControls.Widgets.EmbedWidget.callBaseMethod(this,"render",[div]),div.innerHTML=data,DotNetNuke.UI.WebControls.Widgets.appendDynamicScripts(this._widget.id,scripts)}}},DotNetNuke.UI.WebControls.Widgets.EmbedWidget.inheritsFrom(DotNetNuke.UI.WebControls.Widgets.BaseWidget),DotNetNuke.UI.WebControls.Widgets.EmbedWidget.registerClass("DotNetNuke.UI.WebControls.Widgets.EmbedWidget",DotNetNuke.UI.WebControls.Widgets.BaseWidget),DotNetNuke.UI.WebControls.Widgets.renderWidgetType("DotNetNuke.UI.WebControls.Widgets.EmbedWidget");