function rssRenderingHandler(instanceVarName,result,attributeToUse){var instance=eval(instanceVarName);if(null!=result){var itemCollection=result.value.items;for(var item in itemCollection){var itemData=[];if("object"==typeof itemCollection[item]){var ivalues=DotNetNuke.UI.WebControls.Utility.recurseElement("",itemCollection[item]);for(var iv in ivalues)itemData[iv]=ivalues[iv]}else itemData[item]=itemCollection[item];itemData[attributeToUse]&&instance.addContent(itemData[attributeToUse])}}}Type.registerNamespace("DotNetNuke.UI.WebControls.ContentRotator"),DotNetNuke.UI.WebControls.ContentRotator.Rotator=function(instanceVarName,containerId,width,height,direction,transition,interval,theme,resourcesFolderUrl){DotNetNuke.UI.WebControls.ContentRotator.Rotator.initializeBase(this,[instanceVarName,resourcesFolderUrl,theme,""]),this._control="ContentRotator",this._theme="undefined"==typeof theme?"Simple":theme,this._rssProxyUrl="undefined"==typeof rssProxyUrl?"http://pipes.yahoo.com/pipes/Aqn6j8_H2xG4_N_1JhOy0Q/run?_render=json&_callback=[CALLBACK]&feedUrl=":rssProxyUrl,this.addStyleSheet(),this._height="undefined"==typeof height?200:height,this._width="undefined"==typeof width?400:width,this._direction="undefined"==typeof direction?"left":"left"==direction||"right"==direction||"up"==direction||"down"==direction||"blend"==direction?direction:"left",this._interval="undefined"==typeof interval?2500:interval,this._transition="undefined"==typeof transition?"slide":"slide"==transition||"snap"==transition?transition:"slide",this._container=$get(containerId),this._container.className="Normal "+this.getStylePrefix()+"Container",this._container.style.position="relative",this._container.style.width=this._width+"px",this._container.style.height=this._height+"px",this._container.style.display="block",this._container.innerHTML=this.displayLoader(),this._container.style.overflow="hidden",this._offset="up"==this._direction||"down"==this._direction?this._height:this._width,this._content=[],this._contentprev=0,this._contentcurr=1,this._motion=!1,this._mouse=!1,this._pause=!1,this._archive=null,this._init=!0},DotNetNuke.UI.WebControls.ContentRotator.Rotator.prototype={isPaused:function(){return this._pause},resume:function(){this._pause&&(this._pause=!1,this._container.style.display="block")},pause:function(hide){this._pause||(this._pause=!0,hide&&(this._container.style.display="none"))},getContainer:function(){return this._container},addContent:function(content){if("blend"==this._direction){if(this._content[this._content.length]=content,1==this._content.length){this._container.backgroundImage="url('"+content+"')";var img=document.createElement("img");img.setAttribute("style","border:0; filter: alpha(opacity=0); -moz-opacity: 0; opacity: 0"),img.style.width=this._width+"px",img.style.height=this._height+"px",img.style.position="absolute",img.style.top="0",img.style.left="0",img.src=content,img.id=this._container.id+"_img",this._container.appendChild(img),this._contentcurr=0}}else{var div=document.createElement("div");switch(div.style.position="absolute",div.style.width=this._width+"px",div.style.height=this._height+"px",div.style.overflow="hidden",div.style.left=div.style.top="0px",this._direction){case"up":div.style.top=this._height+"px";break;case"down":div.style.top=-(this._height+2)+"px";break;case"left":div.style.left=this._width+"px";break;case"right":div.style.left=-(this._width+2)+"px"}div.innerHTML=content,this._container.appendChild(this._content[this._content.length]=div)}},addFeedContent:function(url,attributeToUse){var counter=0;try{for(;eval(this._instanceVarName+counter);)counter++}catch(e){}eval(this._instanceVarName+counter+' = new Function("data", "rssRenderingHandler(\''+this._instanceVarName+"', data,'"+attributeToUse+"')\")");var newScript=document.createElement("script");newScript.type="text/javascript",newScript.src=this.getRssProxyUrl(this._instanceVarName+counter)+url.urlEncode(),document.getElementsByTagName("head")[0].appendChild(newScript)},getRssProxyUrl:function(callback){return this._rssProxyUrl.replace("[CALLBACK]",callback)},_scrollLoop:function(){if(0==this._content.length){var self=this;return setTimeout(self.getInstanceVarName()+"._scrollLoop()",50),!1}if(this._pause)return!1;if(!this._motion&&this._mouse)return!1;if(1==this._offset)this._contentprev=this._contentcurr,this._contentcurr=this._contentcurr+1>=this._content.length?0:this._contentcurr+1,"up"==this._direction||"down"==this._direction?(this._content[this._contentcurr].style.top=("down"==this._direction?"-":"")+this._height+"px",this._content[this._contentprev].style.top="0px",this._offset=this._height):(this._content[this._contentcurr].style.left=("right"==this._direction?"-":"")+this._width+"px",this._content[this._contentprev].style.left="0px",this._offset=this._width),this._motion=!1;else{if(this._motion)this._offset/=2;else{this._motion=!0;for(var x=-1;;)if(Math.abs(this._offset)-Math.pow(2,++x)<=Math.abs(this._offset)/2)break;this._offset="up"==this._direction||"left"==this._direction?Math.pow(2,x):-Math.pow(2,x)}"snap"==this._transition&&(this._offset=1),"up"==this._direction||"down"==this._direction?(this._content[this._contentcurr].style.top=this._offset+"px",this._content[this._contentprev].style.top=("down"==this._direction?this._height:-(this._height+2))+this._offset+"px"):(this._content[this._contentcurr].style.left=this._offset+"px",this._content[this._contentprev].style.left=("right"==this._direction?this._width:-(this._width+2))+this._offset+"px");var self=this;setTimeout(self.getInstanceVarName()+"._scrollLoop()",30)}},scroll:function(){var self=this;return this._container.onmouseover=function(){self._mouse=!0},this._container.onmouseout=function(){self._mouse=!1},"blend"==self._direction?(setInterval(self.getInstanceVarName()+"._blendLoop()",self._interval),!1):(self._init&&(self._init=!1,self._scrollLoop()),void setInterval(self.getInstanceVarName()+"._scrollLoop()",self._interval))},_opacity:function(id,opacStart,opacEnd,millisec){var speed=Math.round(millisec/100),timer=0;if(opacStart>opacEnd)for(i=opacStart;i>=opacEnd;i--)setTimeout("_changeOpacity("+i+",'"+id+"')",timer*speed),timer++;else if(opacStart<opacEnd)for(i=opacStart;i<=opacEnd;i++)setTimeout("_changeOpacity("+i+",'"+id+"')",timer*speed),timer++},_changeOpacity:function(opacity,id){var object=$get(id).style;object.opacity=opacity/100,object.MozOpacity=opacity/100,object.KhtmlOpacity=opacity/100,object.filter="alpha(opacity="+opacity+")"},_shiftOpacity:function(id,millisec){0==$get(id).style.opacity?_opacity(id,0,100,millisec):_opacity(id,100,0,millisec)},_blendLoop:function(){var self=this;return 1!=self._content.length&&(!self._mouse&&(self._contentcurr++,self._blendImage(self._contentcurr,self._interval),void(self._contentcurr==self._content.length-1&&(self._contentcurr=0))))},_blendImage:function(contentItem,millisec){var speed=Math.round(millisec/100),timer=0,imageId=this._container.id+"_img";this._container.style.backgroundImage="url("+$get(imageId).src+")",this._changeOpacity(0,imageId),$get(imageId).src=this._content[contentItem];var self=this;for(i=0;i<=100;i++)setTimeout(self.getInstanceVarName()+"._changeOpacity("+i+",'"+imageId+"')",timer*speed),timer++;setTimeout(self.getInstanceVarName()+"._blendLoop()",100*speed)},_currentOpacity:function(id,opacEnd,millisec){var currentOpac=100;$get(id).style.opacity<100&&(currentOpac=100*$get(id).style.opacity),_opacity(id,currentOpac,opacEnd,millisec)}},DotNetNuke.UI.WebControls.ContentRotator.Rotator.registerClass("DotNetNuke.UI.WebControls.ContentRotator.Rotator",DotNetNuke.UI.WebControls.BaseControl);