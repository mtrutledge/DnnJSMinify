"undefined"!=typeof dnn&&null!==dnn||(dnn={}),function($,window,document,undefined){"use strict";var TreeView=this.TreeView=function(element,options){this.$this=$(this),this.$element=$(element),this.options=options,this.init()};TreeView.prototype={init:function(){this.options=$.extend(TreeView.defaults(),this.options),this._onRedrawHandler=$.proxy(this._onRedraw,this),this._onShowChildrenHandler=$.proxy(this._onShowChildren,this)},_createChildrenNodeElement:function(childrenContext,isRoot){if(!childrenContext||0===childrenContext.length)return $([]);var childContext,$childNodeElement,$childrenNodeElement=$("<ul/>");$childrenNodeElement.addClass(this.options.nodeListCss),isRoot&&$childrenNodeElement.addClass(this.options.rootCss);for(var i=0,count=childrenContext.length;i<count;i++)childContext=childrenContext[i],childContext&&($childNodeElement=this._createNodeElement(childContext),$childNodeElement.append(this._createChildrenNodeElement(childContext.children)),$childrenNodeElement.append($childNodeElement));return $childrenNodeElement},showTree:function(nodeContext){if(nodeContext){var nodes=Object.IsArray(nodeContext)?nodeContext:[nodeContext];this._$treeElement=this._createChildrenNodeElement(nodes,!0).hide(),this.$element.empty().append(this._$treeElement),this._$treeElement.slideDown({duration:0,complete:this._onRedrawHandler})}},collapseTree:function(onComplete){var self=this;this._$treeElement&&this._$treeElement.length?this._$treeElement.slideUp({duration:0,complete:function(){$(this).remove(),self._onRedraw(),"function"==typeof onComplete&&onComplete.apply(self)}}):"function"==typeof onComplete&&onComplete.apply(self)},showChildren:function(nodeContext){if(!nodeContext)return null;var $childrenNodeElement=this._createChildrenNodeElement(nodeContext.children).hide(),$nodeElement=this.getNodeElement(nodeContext);return $nodeElement.children("ul").remove(),$nodeElement.append($childrenNodeElement),$childrenNodeElement.slideDown({duration:this.options.expandSpeed,easing:this.options.expandEasing,complete:this._onShowChildrenHandler}),$childrenNodeElement},removeChildren:function(nodeElement){var self=this,nodeContext=this.nodeContext(nodeElement);$(nodeElement).find("ul").slideUp(this.options.collapseSpeed,this.options.collapseEasing,function(){$(this).remove(),self._onRedraw(nodeContext)})},_onRedraw:function(nodeContext){var e=$.Event("onredrawtree");this.$this.trigger(e,[nodeContext])},_onShowChildren:function(nodeContext){var e=$.Event("onredrawtree");this.$this.trigger(e,[nodeContext]),this.$this.trigger("onshowchildren",[nodeContext])},getNodeElement:function(nodeContext){var rootElement=this.getRootElement(),self=this,filterFunction=function(i){var context=self.nodeContext(this);return context===nodeContext},list=$(rootElement).find("li").filter(filterFunction);return list.first()},_createNodeElement:function(nodeContext){if(!nodeContext)return null;var $nodeElement=$("<li/>").addClass(this.options.nodeCss);return this.nodeContext($nodeElement[0],nodeContext),this.$this.trigger("oncreatenode",[$nodeElement[0],nodeContext]),$nodeElement},addNodeClass:function(nodeContext,add,className){if(nodeContext){var $nodeElement=this.getNodeElement(nodeContext),addClass="undefined"==typeof add||add,element=$nodeElement.children().eq(1);addClass?element.addClass(className):element.removeClass(className)}},getRootElement:function(){var $node=this._$treeElement;return $node&&$node.length>0?$node[0]:null},nodeContext:function(element,context){var nodeElement=element?$(element).closest("li")[0]:this.getRootElement();return nodeElement?"undefined"==typeof context?$.data(nodeElement,"tree-node"):($.data(nodeElement,"tree-node",context),context):null}},TreeView._defaults={expandSpeed:200,collapseSpeed:200,expandEasing:null,collapseEasing:null,nodeListCss:"tv-nodes",nodeCss:"tv-node",rootCss:"tv-root"},TreeView.defaults=function(settings,dataAndMethods){return"undefined"!=typeof settings&&$.extend(TreeView._defaults,settings),"undefined"!=typeof dataAndMethods&&$.extend(TreeView._defaults,dataAndMethods),TreeView._defaults}}.apply(dnn,[jQuery,window,document]);