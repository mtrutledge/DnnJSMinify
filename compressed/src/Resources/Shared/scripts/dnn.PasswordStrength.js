"undefined"!=typeof dnn&&null!==dnn||(dnn={}),function($,window,document,undefined){"use strict";var pluginName="passwordStrength",PasswordStrength=this.PasswordStrength=function(element,options){this.element=element,this.options=options,this.init()};PasswordStrength.prototype={constructor:PasswordStrength,init:function(){this.options=$.extend({},PasswordStrength.defaults(),this.options),this.$this=$(this),this.$element=$(this.element),this._$container=this.$element.parent(),this._$meter=$("<div/>").addClass(this.options.meterCss).appendTo(this._$container).width(this.$element.outerWidth());var handler=this;setInterval(function(){handler._$meter.width(handler.$element.outerWidth()),handler._$tooltipContent.width(handler.$element.outerWidth()-20)},50),this._$meterValue=$('<div><span class="" /><span class="" /><span class="" /><span class="last" /></div>').appendTo(this._$meter),this._$meterText=$("<label/>").prependTo(this._$meterValue),this._$tooltipContainer=$('<div class="password-strength-tooltip" />'),this.$element.after(this._$tooltipContainer),this._$tooltipContainer.hide(),this._initializeTooltip(),this.$element.on("change keyup paste input propertychange",$.proxy(this._onInput,this)),this.$element.on("blur",function(){handler._updateTooltipVisible()});var meterHover={over:function(){handler._forceTooltipVisible()},timeout:200,out:function(){handler._updateTooltipVisible()}};this._$meter.hoverIntent(meterHover);var validateFunction=window.ValidatorValidate;"function"==typeof validateFunction&&(window.ValidatorValidate=function(){validateFunction.apply(window,arguments);var validator=arguments[0],field=$("#"+validator.controltovalidate);validator.isvalid?field.removeClass("validate-fail").addClass("validate-success"):field.removeClass("validate-success").addClass("validate-fail")}),this._updateState()},_initializeTooltip:function(){this._$tooltipContent=$("<div/>").addClass("password-strength-tooltip-content").appendTo(this._$tooltipContainer),this._$tooltipContent.width(this.$element.outerWidth()-20),$("<h2 />").html(this.options.passwordRulesHeadText).appendTo(this._$tooltipContent);var list=$("<ul/>").appendTo(this._$tooltipContent);this._$labelAtLeastNChars=$("<label/>").text(this.options.criteriaAtLeastNChars).appendTo($("<li/>").appendTo(list)),this._$labelAtLeastNSpecialChars=$("<label/>").text(this.options.criteriaAtLeastNSpecialChars).appendTo($("<li/>").appendTo(list)),this._$labelValidationExpression=$("<label/>").text(this.options.criteriaValidationExpression).appendTo($("<li/>").appendTo(list)),0===this.options.minNumberOfSpecialChars&&this._$labelAtLeastNSpecialChars.hide(),""===this.options.validationExpression&&this._$labelValidationExpression.hide(),this._strength||(this._strength=this._getStrength(this.$element.val(),this.options)),this._updateTooltipState(this._strength)},_onInput:function(e){"propertychange"===e.type&&"value"!==e.originalEvent.propertyName.toLowerCase()||(""!==this.$element.val()&&this._$meter.addClass("visible"),this._updateState())},_updateState:function(){var password=this.$element.val();this._strength=this._getStrength(password,this.options),this._updateMeterState(this._strength),this._updateTooltipState(this._strength),this._updateFieldState(this._strength)},_updateMeterState:function(strength){var rating=Math.min(strength.rating,strength.maxRating),bgColor="",ratingIndex=0;0===rating?this._$meterText.text(""):rating<3?(this._$meterText.text(this.options.weakText),bgColor=this.options.weakColor,ratingIndex=rating):rating>2&&rating<5?(this._$meterText.text(this.options.fairText),bgColor=this.options.fairColor,ratingIndex=3):rating>4&&(this._$meterText.text(this.options.strongText),bgColor=this.options.strongColor,ratingIndex=4),this._$meter.find("span").css("background-color","").each(function(index,item){index<ratingIndex&&$(this).css("background-color",bgColor)})},_updateTooltipState:function(strength){this._$tooltipContent&&(this._updateCriteriaLabel(this._$labelAtLeastNChars,strength.hasLengthOfNChars),this._updateCriteriaLabel(this._$labelAtLeastNSpecialChars,strength.hasMinNumberOfSpecialChars),this._updateCriteriaLabel(this._$labelValidationExpression,strength.matchValidationExpression))},_updateTooltipVisible:function(){var password=this.$element.val(),strength=this._strength=this._getStrength(password,this.options),matchedPasswordPolicy=this._matchedPasswordPolicy(strength);matchedPasswordPolicy||""===this.$element.val()?this._$tooltipContainer.fadeOut("fast"):this._$tooltipContainer.fadeIn("fast")},_forceTooltipVisible:function(){this._$tooltipContainer.fadeIn("fast")},_updateCriteriaLabel:function($label,satisfied){satisfied?$label.addClass("satisfied"):$label.removeClass("satisfied")},_updateFieldState:function(strength){if(this.$element.val().length>0){var matchedPasswordPolicy=this._matchedPasswordPolicy(strength);matchedPasswordPolicy?this.$element.removeClass("validate-fail").addClass("validate-success"):this.$element.removeClass("validate-success").addClass("validate-fail")}else this.$element.removeClass("validate-success validate-fail")},_matchedPasswordPolicy:function(strength){return strength.hasLengthOfNChars&&(0===this.options.minNumberOfSpecialChars||strength.hasMinNumberOfSpecialChars)&&(""===this.options.validationExpression||strength.matchValidationExpression)},_getStrength:function(password,options){var rating=0,minLength=options.minLength,hasOneUpperCaseChar=!1,hasOneLowerCaseChar=!1,hasMinNumberOfSpecialChars=!1,hasOneNumericChar=!1,hasLengthOfNChars=!1,matchValidationExpression=!1,minNumberOfSpecialChars=options.minNumberOfSpecialChars||0,validationExpression=options.validationExpression||"";if(password.length>0){password.match(/[a-z]/)&&(rating++,hasOneLowerCaseChar=!0),password.match(/[A-Z]/)&&(rating++,hasOneUpperCaseChar=!0),password.match(/[0-9]/g)&&(rating++,hasOneNumericChar=!0);var matches=password.match(/[!,@,#,$,%,&,*,(,),\-,_,=,+,\',\",\\,|,\,,<,.,>,;,:,/,?,\[,{,\],}]/g);matches&&matches.length>=minNumberOfSpecialChars&&(rating++,hasMinNumberOfSpecialChars=!0),password.length>=minLength&&(rating++,hasLengthOfNChars=!0),password.length>=minLength+3&&rating++,validationExpression&&(matchValidationExpression=new RegExp(validationExpression,"g").test(password))}return{rating:rating,maxRating:5,hasOneUpperCaseChar:hasOneUpperCaseChar,hasOneLowerCaseChar:hasOneLowerCaseChar,hasMinNumberOfSpecialChars:hasMinNumberOfSpecialChars,hasOneNumericChar:hasOneNumericChar,hasLengthOfNChars:hasLengthOfNChars,matchValidationExpression:matchValidationExpression}}},PasswordStrength._defaults={},PasswordStrength.defaults=function(settings){return"undefined"!=typeof settings&&$.extend(PasswordStrength._defaults,settings),PasswordStrength._defaults},$.fn[pluginName]=function(option){var args=$.makeArray(arguments),params=args.slice(1);return this.each(function(){var $this=$(this),instance=$this.data(pluginName);if(!instance){var options=$.extend({},"object"==typeof option&&option);$this.data(pluginName,instance=new PasswordStrength(this,options))}"string"==typeof option&&instance[option].apply(instance,params)})}}.apply(dnn,[jQuery,window,document]),dnn.initializePasswordStrength=function(selector,options){$(document).ready(function(){$(selector).passwordStrength(options)})};