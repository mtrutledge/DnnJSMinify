function tabClickHandler(instanceVarName,tabIndex){var instance=eval(instanceVarName);DotNetNuke.UI.WebControls.FeedBrowser.renderSectionMenu(instance.getElementIdPrefix()+"SectionsContainer",instanceVarName,"sectionClickHandler",0,tabIndex)}function sectionClickHandler(instanceVarName,sectionIndex,tabIndex){var instance=eval(instanceVarName);DotNetNuke.UI.WebControls.FeedBrowser.renderCategoryMenu(instance.getElementIdPrefix()+"CategoriesContainer",instanceVarName,"categoryClickHandler",-1,sectionIndex,tabIndex)}function categoryClickHandler(instanceVarName,categoryIndex,sectionIndex,tabIndex){var instance=eval(instanceVarName);DotNetNuke.UI.WebControls.FeedBrowser.renderFeed(instance.getElementIdPrefix()+"ContentContainer",instanceVarName,categoryIndex,sectionIndex,tabIndex)}function searchClickHandler(instanceVarName,sectionIndex,tabIndex){var instance=eval(instanceVarName),keywordField=$get(instance.getElementIdPrefix()+"FBKeyword"),keyword=keywordField.value.trim();""!=keyword&&DotNetNuke.UI.WebControls.FeedBrowser.renderFeed(instance.getElementIdPrefix()+"ContentContainer",instanceVarName,-1,sectionIndex,tabIndex,keyword)}function rssRenderingHandler(instanceVarName,template,result){var instance=eval(instanceVarName);if(!instance._ignoreAsyncContent){var tmp="";if(null!=result){var templateHtml=instance.getTemplates()[template],headerHtml=instance.getHeaders()[template];"undefined"==typeof templateHtml&&(templateHtml=instance.getTemplates().default);var feedInfo=new DotNetNuke.UI.WebControls.FeedBrowser.RssInfo(result,templateHtml,headerHtml,instance.getAllowHtmlDescription()),items=feedInfo.formattedItems;for(var i in items)tmp+=items[i]}$get(instance.getElementIdPrefix()+"ContentContainer").innerHTML=tmp}}Type.registerNamespace("DotNetNuke.UI.WebControls.FeedBrowser"),DotNetNuke.UI.WebControls.FeedBrowser.Browser=function(instanceVarName,tabStripInstance,rssProxyUrl,elementIdPrefix,allowHtmlDescription,theme,defaultTemplate,resourcesFolderUrl){DotNetNuke.UI.WebControls.FeedBrowser.Browser.initializeBase(this,[instanceVarName,resourcesFolderUrl,theme,elementIdPrefix]),this._control="FeedBrowser",this._theme="undefined"==typeof theme?"Platinum":theme,this._tabStripInstance=tabStripInstance,this._templates=[],this._headers=[],this._tabs=[],this._defaultTemplate="undefined"==typeof defaultTemplate?"default":defaultTemplate,this._rssProxyUrl="undefined"==typeof rssProxyUrl?"http://pipes.yahoo.com/pipes/Aqn6j8_H2xG4_N_1JhOy0Q/run?_render=json&_callback=[CALLBACK]&feedUrl=":rssProxyUrl,this._allowHtmlDescription="undefined"==typeof allowHtmlDescription||allowHtmlDescription,this._ignoreAsyncContent=!1},DotNetNuke.UI.WebControls.FeedBrowser.Browser.prototype={getDefaultTemplate:function(){return this._defaultTemplate},getRssProxyUrl:function(callback){return this._rssProxyUrl.replace("[CALLBACK]",callback)},getAllowHtmlDescription:function(){return this._allowHtmlDescription},getTabStripInstance:function(){return this._tabStripInstance},setDefaultTemplate:function(defaultTemplate){this._defaultTemplate=defaultTemplate},setRssProxyUrl:function(rssProxyUrl){this._rssProxyUrl=rssProxyUrl},setAllowHtmlDescription:function(allowHtmlDescription){this._allowHtmlDescription=allowHtmlDescription},setTabStripInstance:function(tabStripInstance){this._tabStripInstance=tabStripInstance},getTemplates:function(){return this._templates},getHeaders:function(){return this._headers},render:function(){try{var fbScript=document.createElement("script");fbScript.type="text/javascript",fbScript.src="http://www.dotnetnuke.com/Portals/25/SolutionsExplorer/scripts/templates.js",document.getElementsByTagName("head")[0].appendChild(fbScript)}catch(e){}this.addStyleSheet();var html=new Sys.StringBuilder('<table class="'+this.getStylePrefix()+'MainTable" cellpadding="0" cellspacing="0">');html.append('<tr><td align="left" valign="top" colspan="2" nowrap id="'+this._elementIdPrefix+'TabsContainer"></td></tr>'),html.append('<tr><td class="'+this.getStylePrefix()+'NavTop" colspan="2" id="'+this._elementIdPrefix+'SectionsContainer" valign="middle">&nbsp;</td></tr>'),html.append('<tr><td class="'+this.getStylePrefix()+'NavLeftCurve">&nbsp;</td>'),html.append('<td><div id="PreviewContainer" class="'+this.getStylePrefix()+'PreviewContainer">'),html.append('<table width="100%"><tr><td align="right" class="SubHead '+this.getStylePrefix()+'PreviewContainerTitle"><span onClick="$get(\'PreviewContainer\').style.display=\'none\'" style="padding:5px;cursor:pointer;font-size:12pt">X</span>&nbsp;&nbsp;</td></tr></table>'),html.append('<iframe id="PreviewBrowser" frameborder="0" class="'+this.getStylePrefix()+'PreviewBrowser"></iframe>'),html.append("</div></td></tr>"),html.append('<tr><td class="'+this.getStylePrefix()+'NavLeft" align="left" valign="top" id="'+this._elementIdPrefix+'CategoriesContainer">&nbsp;</td>'),html.append('<td class="Normal '+this.getStylePrefix()+'Content" align="left" valign="top" id="'+this._elementIdPrefix+'ContentContainer">&nbsp;</td></tr>'),html.append('<tr><td class="'+this.getStylePrefix()+'NavBottom" colspan="2">&nbsp;</td></tr></table>'),document.write(html.toString());try{for(var t in htmlTemplates)this._templates[t]=htmlTemplates[t]}catch(e){}try{for(var t in htmlHeaders)this._headers[t]=htmlHeaders[t]}catch(e){}this._templates.default||(this._templates.default='<table><tr><td class="Head" align="left" valign="middle" style="padding-bottom:10px"><a href="[[link]]" target="_blank" class="Head">[[title]]</a></td></tr><tr><td align="left" valign="top" class="Normal">[[description]]</td></tr></table><br /><br />'),this._tabStripInstance.setContainerId(this._elementIdPrefix+"TabsContainer"),this._tabStripInstance.setContext(this._instanceVarName),this._tabStripInstance.setTheme(this._theme),this._tabStripInstance.setResourcesFolderUrl(this._resourcesFolderUrl),this._tabStripInstance.setClickHandler("tabClickHandler"),this._tabStripInstance.setTabCollection(this._tabs),this._tabStripInstance.render()},getTabs:function(){return this._tabs},setTabs:function(tabs){this._tabs=tabs},getTabsList:function(){for(var list="",t=0;t<this._tabs.length;t++)list+=(""==list?"":",")+this._tabs[t].label;return list},addTab:function(tabInfo){return this._tabs[this._tabs.length]=tabInfo,tabInfo}},DotNetNuke.UI.WebControls.FeedBrowser.Browser.registerClass("DotNetNuke.UI.WebControls.FeedBrowser.Browser",DotNetNuke.UI.WebControls.BaseControl),DotNetNuke.UI.WebControls.FeedBrowser.TabInfo=function(label,opmlUrl,template){this._label=label,this._sections=[],this._opmlUrl=opmlUrl,template?this._template=template:this._template=""},DotNetNuke.UI.WebControls.FeedBrowser.TabInfo.prototype={getLabel:function(){return this._label},getOpmlUrl:function(){return this._opmlUrl},getTemplate:function(){return this._template},getSections:function(){return this._sections},addSection:function(sectionInfo){return this._sections[this._sections.length]=sectionInfo,sectionInfo}},DotNetNuke.UI.WebControls.FeedBrowser.TabInfo.registerClass("DotNetNuke.UI.WebControls.FeedBrowser.TabInfo"),DotNetNuke.UI.WebControls.FeedBrowser.SectionInfo=function(label,searchUrl,template){this._categories=[],this._defaultCategoryIndex=0,this._label=label,this._searchUrl=searchUrl,template?this._template=template:this._template=""},DotNetNuke.UI.WebControls.FeedBrowser.SectionInfo.prototype={getLabel:function(){return this._label},getSearchUrl:function(){return this._searchUrl},getTemplate:function(){return this._template},getCategories:function(){return this._categories},addCategory:function(categoryInfo){return this._categories[this._categories.length]=categoryInfo,categoryInfo},setDefaultCategory:function(index){index<this._categories.length&&index>-1&&(this._defaultCategoryIndex=index)},getDefaultCategory:function(){return this._defaultCategoryIndex}},DotNetNuke.UI.WebControls.FeedBrowser.SectionInfo.registerClass("DotNetNuke.UI.WebControls.FeedBrowser.SectionInfo"),DotNetNuke.UI.WebControls.FeedBrowser.CategoryInfo=function(label,feedUrl,depth,template){this._label=label,this._feedUrl=feedUrl,this._depth=depth>-1?depth:0,template?this._template=template:this._template=""},DotNetNuke.UI.WebControls.FeedBrowser.CategoryInfo.prototype={getLabel:function(){return this._label},getFeedUrl:function(){return this._feedUrl},getEncodedFeedUrl:function(){var url=this._feedUrl+(this._feedUrl.indexOf("?")>-1?"&":"?")+"random="+this.getCacheKey();return url.urlEncode()},getDepth:function(){return this._depth},getTemplate:function(){return this._template},getCacheKey:function(){var now=new Date,year=now.getYear(),month=(now.getMonth()>10?"":"0")+now.getMonth(),hour=now.getHours(),minutes=now.getMinutes()-now.getMinutes()%5,modMinutes=(minutes>10?"":"0")+minutes;return year+month+hour+modMinutes}},DotNetNuke.UI.WebControls.FeedBrowser.CategoryInfo.registerClass("DotNetNuke.UI.WebControls.FeedBrowser.CategoryInfo"),DotNetNuke.UI.WebControls.FeedBrowser.RssInfo=function(feed,template,header,allowHtml){this.formattedItems=[];var itemCollection=feed.value.items,feedHeader=[];header&&(feedHeader[0]=header);for(var item in itemCollection){var itemData=[];if("object"==typeof itemCollection[item]){var ivalues=DotNetNuke.UI.WebControls.Utility.recurseElement("",itemCollection[item]);for(var iv in ivalues)itemData[iv]=ivalues[iv]}else itemData[item]=itemCollection[item];var formattedItem=template;if("@@"==formattedItem.substr(0,2)){for(var attribute in itemData){var dataValue=allowHtml?itemData[attribute].xmlEntityReplace():itemData[attribute];formattedItem=formattedItem.replaceAll("[["+attribute+"]]",dataValue.replaceAll("'","&#39;").replaceAll('"',"&#34;").replaceAll(",","&#44;").replaceAll("\n"," "))}formattedItem=eval(formattedItem.substr(2))}else for(var attribute in itemData){var dataValue=allowHtml?itemData[attribute].xmlEntityReplace():itemData[attribute];formattedItem=formattedItem.replaceAll("[["+attribute+"]]",dataValue)}this.formattedItems[this.formattedItems.length]=formattedItem}this.formattedItems=feedHeader.concat(this.formattedItems.sort())},DotNetNuke.UI.WebControls.FeedBrowser.RssInfo.registerClass("DotNetNuke.UI.WebControls.FeedBrowser.RssInfo"),DotNetNuke.UI.WebControls.FeedBrowser.renderSectionMenu=function(containerId,instanceVarName,clickHandler,displaySectionIndex,currentTabIndex){var container=$get(containerId);if(container){var selectedSection=-99;try{var instance=eval(instanceVarName);instance._ignoreAsyncContent=!1;var tabs=instance.getTabs(),sections=tabs[currentTabIndex].getSections(),stylePrefix=instance.getStylePrefix();if(sections.length>0){null!=displaySectionIndex&&displaySectionIndex<sections.length&&(selectedSection=displaySectionIndex),selectedSection==-99&&(selectedSection=0);for(var sectionHTML='<ul class="'+stylePrefix+'SectionMenu">',t=0;t<sections.length;t++)sectionHTML+="<li class='"+(t==selectedSection?"NormalBold "+stylePrefix+"SectionMenu-Selected":"Normal "+stylePrefix+"SectionMenu-Normal")+"'",clickHandler&&(sectionHTML+=" onClick='DotNetNuke.UI.WebControls.FeedBrowser.renderSectionMenu(\""+containerId+'","'+instanceVarName+'","'+clickHandler+'",'+t+","+currentTabIndex+")'"),sectionHTML+=">"+sections[t].getLabel()+"</li>";sectionHTML+="</ul>",container.innerHTML=sectionHTML}else container.innerHTML="&nbsp;"}catch(e){container.innerHTML=e.message}try{eval(clickHandler+'("'+instanceVarName+'",'+selectedSection+","+currentTabIndex+")")}catch(e){container.innerHTML=e.message}}},DotNetNuke.UI.WebControls.FeedBrowser.renderCategoryMenu=function(containerId,instanceVarName,clickHandler,displayCategoryIndex,currentSectionIndex,currentTabIndex){var container=$get(containerId);if(container){var selectedCategory=-99;try{var instance=eval(instanceVarName);instance._ignoreAsyncContent=!1;var tabs=instance.getTabs(),sections=tabs[currentTabIndex].getSections(),categories=sections[currentSectionIndex].getCategories(),stylePrefix=instance.getStylePrefix();if(categories.length>0){displayCategoryIndex==-1&&(displayCategoryIndex=sections[currentSectionIndex].getDefaultCategory()),displayCategoryIndex<categories.length&&(selectedCategory=displayCategoryIndex),selectedCategory==-99&&(selectedCategory=0);var categoryHTML=new Sys.StringBuilder('<table class="'+stylePrefix+'Category" cellpadding="0" cellspacing="0">');"undefined"!=typeof sections[currentSectionIndex].getSearchUrl()&&(categoryHTML.append('<tr><td class="Normal Off" align="left" valign="middle"><input id="'+instance.getElementIdPrefix()+'FBKeyword" class="Normal SearchBox" type="text" onKeyPress="return DotNetNuke.UI.WebControls.Utility.checkEnter(event, \''+instance.getElementIdPrefix()+"FBSearch')\"> "),categoryHTML.append('<input id="'+instance.getElementIdPrefix()+'FBSearch" onClick="searchClickHandler(\''+instanceVarName+"',"+currentSectionIndex+","+currentTabIndex+')" class="SearchButton" type="button">'),categoryHTML.append("<br />&nbsp;</td></tr>"));for(var t=0;t<categories.length;t++){if(categoryHTML.append('<tr><td class="'+(t==selectedCategory?"NormalBold On":"Normal Off")+'" align="left" valign="middle"'),clickHandler&&categoryHTML.append(" onClick='DotNetNuke.UI.WebControls.FeedBrowser.renderCategoryMenu(\""+containerId+'","'+instanceVarName+'","'+clickHandler+'",'+t+","+currentSectionIndex+","+currentTabIndex+")'"),categoryHTML.append(">"),categories[t].getDepth()>0)for(var d=0;d<categories[t].getDepth();d++)categoryHTML.append('<div class="Indent">&nbsp;</div>');categoryHTML.append(categories[t].getLabel()+"</td>"),categoryHTML.append('<td class="'+(t==selectedCategory?"Pointer":"NoPointer")+'">&nbsp;</td></tr>')}categoryHTML.append("</table>"),container.innerHTML=categoryHTML.toString();try{eval(clickHandler+'("'+instanceVarName+'",'+selectedCategory+","+currentSectionIndex+","+currentTabIndex+")")}catch(e){container.innerHTML=e.message}}else container.innerHTML="&nbsp;",DotNetNuke.UI.WebControls.FeedBrowser.renderFeed(instance.getElementIdPrefix()+"ContentContainer",instanceVarName,-2,currentSectionIndex,currentTabIndex)}catch(e){container.innerHTML=e.message}}},DotNetNuke.UI.WebControls.FeedBrowser.renderFeed=function(containerId,instanceVarName,currentCategoryIndex,currentSectionIndex,currentTabIndex,keyword){var container=$get(containerId);if(container)try{var instance=eval(instanceVarName),tabs=instance.getTabs(),sections=tabs[currentTabIndex].getSections(),stylePrefix=instance.getStylePrefix(),categoryInfo=null;if(currentCategoryIndex==-1){var searchUrl=sections[currentSectionIndex].getSearchUrl();searchUrl.indexOf("[KEYWORD]")>-1?searchUrl=searchUrl.replace("[KEYWORD]",escape(keyword)):searchUrl+=(searchUrl.indexOf("?")>-1?"&":"?")+"keyword="+escape(keyword),categoryInfo=new DotNetNuke.UI.WebControls.FeedBrowser.CategoryInfo("Search",searchUrl,0)}else if(currentCategoryIndex==-2)instance._ignoreAsyncContent=!0,categoryInfo=new DotNetNuke.UI.WebControls.FeedBrowser.CategoryInfo("Feed",sections[currentSectionIndex].getSearchUrl(),0);else{var categories=sections[currentSectionIndex].getCategories();categoryInfo=categories[currentCategoryIndex]}if(categoryInfo){container.innerHTML=instance.displayLoader();var template="";if(template=""!=categoryInfo.getTemplate()?categoryInfo.getTemplate():""!=sections[currentSectionIndex].getTemplate()?sections[currentSectionIndex].getTemplate():""!=tabs[currentTabIndex].getTemplate()?tabs[currentTabIndex].getTemplate():instance.getDefaultTemplate(),"@@"==template.substring(0,2)){instance._ignoreAsyncContent=!0;var frameHeight=template.substring(2,10),newHtml='<iframe frameborder="no" src="'+categoryInfo.getFeedUrl()+'" style="width:100%;height:'+frameHeight+';border:0"></iframe>';container.innerHTML=newHtml}else{var counter=0;try{for(;eval(instanceVarName+counter);)counter++}catch(e){}eval(instanceVarName+counter+' = new Function("data", "rssRenderingHandler(\''+instanceVarName+"', '"+template+"', data)\")");var newScript=document.createElement("script");newScript.type="text/javascript",newScript.src=instance.getRssProxyUrl(instanceVarName+counter)+categoryInfo.getEncodedFeedUrl(),document.getElementsByTagName("head")[0].appendChild(newScript)}}else container.innerHTML="&nbsp;"}catch(e){container.innerHTML=e.message}};