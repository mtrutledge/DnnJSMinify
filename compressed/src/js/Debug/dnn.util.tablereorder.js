Type.registerNamespace("dnn.util"),dnn.extend(dnn.util,{tableReorderMove:function(ctl,bUp,sKey){var oTR=dnn.dom.getParentByTagName(ctl,"tr");if(null!=oTR){var oCtr=oTR.parentNode;"#text"==oCtr.childNodes[oCtr.childNodes.length-1].nodeName&&dnn.dom.removeChild(oCtr.childNodes[oCtr.childNodes.length-1]);var iIdx=oTR.rowIndex;"-1"==dnn.dom.getAttr(oTR,"origidx","")&&this.tableReorderSetOriginalIndexes(oCtr);var iNextIdx=bUp?this.tableReorderGetPrev(oCtr,iIdx-1):this.tableReorderGetNext(oCtr,iIdx+1);if(iNextIdx>-1){var aryValues2,oSwapNode,aryValues=this.getInputValues(oTR);dnn.dom.removeChild(oTR),oCtr.childNodes.length>iNextIdx?(oSwapNode=oCtr.childNodes[iNextIdx],aryValues2=this.getInputValues(oSwapNode),oCtr.insertBefore(oTR,oSwapNode)):oCtr.appendChild(oTR),this.setInputValues(oTR,aryValues),oSwapNode&&this.setInputValues(oSwapNode,aryValues2),dnn.setVar(sKey,this.tableReorderGetNewRowOrder(oCtr))}return!0}return!1},getInputValues:function(oCtl){for(var aryInputs=dnn.dom.getByTagName("input",oCtl),aryValues=new Array,i=0;i<aryInputs.length;i++)"checkbox"==aryInputs[i].type&&(aryValues[i]=aryInputs[i].checked);return aryValues},setInputValues:function(oCtl,aryValues){for(var aryInputs=dnn.dom.getByTagName("input",oCtl),i=0;i<aryInputs.length;i++)"checkbox"==aryInputs[i].type&&(aryInputs[i].checked=aryValues[i])},tableReorderGetNext:function(oParent,iStartIdx){for(var i=iStartIdx;i<oParent.childNodes.length;i++){var oCtl=oParent.childNodes[i];if(""!=dnn.dom.getAttr(oCtl,"origidx",""))return i}return-1},tableReorderGetPrev:function(oParent,iStartIdx){for(var i=iStartIdx;i>=0;i--){var oCtl=oParent.childNodes[i];if(""!=dnn.dom.getAttr(oCtl,"origidx",""))return i}return-1},tableReorderSetOriginalIndexes:function(oParent){for(var iIdx=0,i=0;i<oParent.childNodes.length;i++){var oCtl=oParent.childNodes[i];""!=dnn.dom.getAttr(oCtl,"origidx","")&&(oCtl.setAttribute("origidx",iIdx.toString()),iIdx++)}},tableReorderGetNewRowOrder:function(oParent){for(var sIdx,sRet="",i=0;i<oParent.childNodes.length;i++){var oCtl=oParent.childNodes[i];sIdx=dnn.dom.getAttr(oCtl,"origidx",""),""!=sIdx&&(sRet+=(sRet.length>0?",":"")+sIdx)}return sRet},checkallChecked:function(oCtl,iCellIndex){setTimeout(function(){for(var bChecked=oCtl.checked,oTD=dnn.dom.getParentByTagName(oCtl,"td"),oTR=oTD.parentNode,oCtr=oTR.parentNode,iOffset=0,i=0;i<iCellIndex;i++)null==oTR.childNodes[i].tagName&&iOffset++;for(var oChk,i=0;i<oCtr.childNodes.length;i++)oTR=oCtr.childNodes[i],oTD=oTR.childNodes[iCellIndex+iOffset],null!=oTD&&(oChk=dnn.dom.getByTagName("input",oTD),oChk.length>0&&(oChk[0].checked=bChecked))},10)}});