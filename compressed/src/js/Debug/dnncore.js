function __dnn_ClientAPIEnabled(){return"undefined"!=typeof dnn}function __dnn_Page_OnLoad(){__dnn_ClientAPIEnabled()&&dnn.dom.attachEvent(window,"onscroll",__dnn_bodyscroll),__dnn_m_bPageLoaded=!0}function __dnn_KeyDown(iKeyCode,sFunc,e){if(null==e&&(e=window.event),e.keyCode==iKeyCode)return eval(unescape(sFunc)),!1}function __dnn_bodyscroll(){var oF=document.forms[0];__dnn_ClientAPIEnabled()&&__dnn_m_bPageLoaded&&"undefined"!=typeof oF.ScrollTop&&(oF.ScrollTop.value=document.documentElement.scrollTop?document.documentElement.scrollTop:dnn.dom.getByTagName("body")[0].scrollTop)}function __dnn_setScrollTop(iTop){if(__dnn_ClientAPIEnabled()){null==iTop&&(iTop=document.forms[0].ScrollTop.value);var sID=dnn.getVar("ScrollToControl");if(null!=sID&&sID.length>0){var oCtl=dnn.dom.getById(sID);null!=oCtl&&(iTop=dnn.dom.positioning.elementTop(oCtl),dnn.setVar("ScrollToControl",""))}"hidden"!=document.getElementsByTagName("html")[0].style.overflow&&window.scrollTo(0,iTop)}}function __dnn_SetInitialFocus(sID){var oCtl=dnn.dom.getById(sID);null!=oCtl&&__dnn_CanReceiveFocus(oCtl)&&oCtl.focus()}function __dnn_CanReceiveFocus(e){if("none"!=e.style.display&&e.tabIndex>-1&&0==e.disabled&&"hidden"!=e.style.visible){for(var eParent=e.parentElement;null!=eParent&&"BODY"!=eParent.tagName;){if("none"==eParent.style.display||eParent.disabled||"hidden"==eParent.style.visible)return!1;eParent=eParent.parentElement}return!0}return!1}function __dnn_ContainerMaxMin_OnClick(oLnk,sContentID){var oContent=dnn.dom.getById(sContentID);if(null!=oContent){var sMaxFile,sMaxIcon,sMinIcon,oBtn=oLnk.childNodes[0],sContainerID=dnn.getVar("containerid_"+sContentID),sCookieID=dnn.getVar("cookieid_"+sContentID),sCurrentFile=oBtn.src.toLowerCase().substr(oBtn.src.lastIndexOf("/"));sMinIcon=dnn.getVar("min_icon_"+sContainerID)?dnn.getVar("min_icon_"+sContainerID):dnn.getVar("min_icon"),sMaxIcon=dnn.getVar("max_icon_"+sContainerID)?dnn.getVar("max_icon_"+sContainerID):dnn.getVar("max_icon"),sMaxFile=sMaxIcon.toLowerCase().substr(sMaxIcon.lastIndexOf("/"));var iNum=5,animf=dnn.getVar("animf_"+sContentID);return null!=animf&&(iNum=new Number(animf)),sCurrentFile==sMaxFile?(oBtn.src=sMinIcon,dnn.dom.expandElement(oContent,iNum),oBtn.title=dnn.getVar("min_text"),null!=sCookieID?"true"==dnn.getVar("__dnn_"+sContainerID+":defminimized")?dnn.dom.setCookie(sCookieID,"true",365):dnn.dom.deleteCookie(sCookieID):dnn.setVar("__dnn_"+sContainerID+"_Visible","true")):(oBtn.src=sMaxIcon,dnn.dom.collapseElement(oContent,iNum),oBtn.title=dnn.getVar("max_text"),null!=sCookieID?"true"==dnn.getVar("__dnn_"+sContainerID+":defminimized")?dnn.dom.deleteCookie(sCookieID):dnn.dom.setCookie(sCookieID,"false",365):dnn.setVar("__dnn_"+sContainerID+"_Visible","false")),!0}return!1}function __dnn_Help_OnClick(sHelpID){var oHelp=dnn.dom.getById(sHelpID);return null!=oHelp&&("none"==oHelp.style.display?oHelp.style.display="":oHelp.style.display="none",!0)}function __dnn_SectionMaxMin(oBtn,sContentID){var oContent=dnn.dom.getById(sContentID);if(null!=oContent){var sVal,sMaxIcon=oBtn.getAttribute("max_icon"),sMinIcon=oBtn.getAttribute("min_icon"),bCallback=null!=oBtn.getAttribute("userctr");return"none"==oContent.style.display?(oBtn.src=sMinIcon,oContent.style.display="",bCallback?sVal="True":dnn.setVar(oBtn.id+":exp",1)):(oBtn.src=sMaxIcon,oContent.style.display="none",bCallback?sVal="False":dnn.setVar(oBtn.id+":exp",0)),bCallback&&dnncore.setUserProp(oBtn.getAttribute("userctr"),oBtn.getAttribute("userkey"),sVal,null),!0}return!1}function __dnn_enableDragDrop(){for(var aryTitles,aryConts=dnn.getVar("__dnn_dragDrop").split(";"),i=0;i<aryConts.length;i++)if(aryTitles=aryConts[i].split(" "),aryTitles[0].length>0){var oCtr=dnn.dom.getById(aryTitles[0]),oTitle=dnn.dom.getById(aryTitles[1]);null!=oCtr&&null!=oTitle&&(oCtr.setAttribute("moduleid",aryTitles[2]),dnn.dom.positioning.enableDragAndDrop(oCtr,oTitle,"__dnn_dragComplete()","__dnn_dragOver()"))}}function __dnn_dragOver(){if(__dnn_dragEventCount++,__dnn_dragEventCount%75==0){var oCont=dnn.dom.getById(dnn.dom.positioning.dragCtr.contID),oPane=__dnn_getMostSelectedPane(dnn.dom.positioning.dragCtr);if(null!=__dnn_oPrevSelPane&&(__dnn_oPrevSelPane.pane.style.border=__dnn_oPrevSelPane.origBorder),null!=oPane){__dnn_oPrevSelPane=oPane,oPane.pane.style.border="4px double "+DNN_HIGHLIGHT_COLOR;for(var oPrevCtl,oNextCtl,iIndex=__dnn_getPaneControlIndex(oCont,oPane),i=0;i<oPane.controls.length;i++)if(iIndex>i&&oPane.controls[i].id!=oCont.id&&(oPrevCtl=oPane.controls[i]),iIndex<=i&&oPane.controls[i].id!=oCont.id){oNextCtl=oPane.controls[i];break}null!=__dnn_oPrevSelModule&&(dnn.dom.getNonTextNode(__dnn_oPrevSelModule.control).style.border=__dnn_oPrevSelModule.origBorder),null!=oNextCtl?(__dnn_oPrevSelModule=oNextCtl,dnn.dom.getNonTextNode(oNextCtl.control).style.borderTop="5px groove "+DNN_HIGHLIGHT_COLOR):null!=oPrevCtl&&(__dnn_oPrevSelModule=oPrevCtl,dnn.dom.getNonTextNode(oPrevCtl.control).style.borderBottom="5px groove "+DNN_HIGHLIGHT_COLOR)}}}function __dnn_dragComplete(){var oCtl=dnn.dom.getById(dnn.dom.positioning.dragCtr.contID),sModuleID=oCtl.getAttribute("moduleid");null!=__dnn_oPrevSelPane&&(__dnn_oPrevSelPane.pane.style.border=__dnn_oPrevSelPane.origBorder),null!=__dnn_oPrevSelModule&&(dnn.dom.getNonTextNode(__dnn_oPrevSelModule.control).style.border=__dnn_oPrevSelModule.origBorder);var iIndex,oPane=__dnn_getMostSelectedPane(dnn.dom.positioning.dragCtr);if(null==oPane)for(var oPanes=__dnn_Panes(),i=0;i<oPanes.length;i++)oPanes[i].id==oCtl.parentNode.id&&(oPane=oPanes[i]);null!=oPane&&(iIndex=__dnn_getPaneControlIndex(oCtl,oPane),__dnn_MoveToPane(oPane,oCtl,iIndex),dnn.callPostBack("MoveToPane","moduleid="+sModuleID,"pane="+oPane.paneName,"order="+2*iIndex))}function __dnn_MoveToPane(oPane,oCtl,iIndex){if(null!=oPane){for(var aryCtls=new Array,i=iIndex;i<oPane.controls.length;i++)oPane.controls[i].control.id!=oCtl.id&&(aryCtls[aryCtls.length]=oPane.controls[i].control),dnn.dom.removeChild(oPane.controls[i].control);dnn.dom.appendChild(oPane.pane,oCtl),oCtl.style.top=0,oCtl.style.left=0,oCtl.style.position="relative";for(var i=0;i<aryCtls.length;i++)dnn.dom.appendChild(oPane.pane,aryCtls[i]);__dnn_RefreshPanes()}else oCtl.style.top=0,oCtl.style.left=0,oCtl.style.position="relative"}function __dnn_RefreshPanes(){var aryPanes=dnn.getVar("__dnn_Panes").split(";"),aryPaneNames=dnn.getVar("__dnn_PaneNames").split(";");__dnn_m_aryPanes=new Array;for(var i=0;i<aryPanes.length;i++)aryPanes[i].length>0&&(__dnn_m_aryPanes[__dnn_m_aryPanes.length]=new __dnn_Pane(dnn.dom.getById(aryPanes[i]),aryPaneNames[i]))}function __dnn_Panes(){return null==__dnn_m_aryPanes&&(__dnn_m_aryPanes=new Array,__dnn_RefreshPanes()),__dnn_m_aryPanes}function __dnn_Modules(sModuleID){return null==__dnn_m_aryModules&&__dnn_RefreshPanes(),__dnn_m_aryModules[sModuleID]}function __dnn_getMostSelectedPane(oContent){for(var iScore,oTopPane,oCDims=new dnn.dom.positioning.dims(oContent),iTopScore=0,i=0;i<__dnn_Panes().length;i++){var oPane=__dnn_Panes()[i],oPDims=new dnn.dom.positioning.dims(oPane.pane);iScore=dnn.dom.positioning.elementOverlapScore(oPDims,oCDims),iScore>iTopScore&&(iTopScore=iScore,oTopPane=oPane)}return oTopPane}function __dnn_getPaneControlIndex(oContent,oPane){if(null!=oPane){var oCtl,oCDims=new dnn.dom.positioning.dims(oContent);if(0==oPane.controls.length)return 0;for(var i=0;i<oPane.controls.length;i++){oCtl=oPane.controls[i];var oIDims=new dnn.dom.positioning.dims(oCtl.control);if(oCDims.t<oIDims.t)return oCtl.index}return null!=oCtl?oCtl.index+1:0}}function __dnn_Pane(ctl,sPaneName){this.pane=ctl,this.id=ctl.id,this.controls=new Array,this.origBorder=ctl.style.border,this.paneName=sPaneName;for(var iIndex=0,strModuleOrder="",i=0;i<ctl.childNodes.length;i++){var oNode=ctl.childNodes[i];if(dnn.dom.isNonTextNode(oNode)){null==__dnn_m_aryModules&&(__dnn_m_aryModules=new Array);var sModuleID=oNode.getAttribute("moduleid");null!=sModuleID&&sModuleID.length>0&&(strModuleOrder+=sModuleID+"~",this.controls[this.controls.length]=new __dnn_PaneControl(oNode,iIndex),__dnn_m_aryModules[sModuleID]=oNode.id,iIndex+=1)}}this.moduleOrder=strModuleOrder}function __dnn_PaneControl(ctl,iIndex){this.control=ctl,this.id=ctl.id,this.index=iIndex,this.origBorder=ctl.style.border}function __dnn_ShowModalPage(urlPage){dnnModal.show(urlPage,!0,550,950,!0,"")}function __dnncore(){this.GetUserVal=0,this.SetUserVal=1}var DNN_COL_DELIMITER=String.fromCharCode(16),DNN_ROW_DELIMITER=String.fromCharCode(15),__dnn_m_bPageLoaded=!1;window.addEventListener?window.addEventListener("load",__dnn_Page_OnLoad,!1):window.attachEvent("onload",__dnn_Page_OnLoad);var __dnn_oPrevSelPane,__dnn_oPrevSelModule,__dnn_dragEventCount=0,__dnn_m_aryPanes,__dnn_m_aryModules;__dnncore.prototype={getUserProp:function(sNameCtr,sKey,pFunc){this._doUserCallBack(dnncore.GetUserVal,sNameCtr,sKey,null,new dnncore.UserPropArgs(sNameCtr,sKey,pFunc))},setUserProp:function(sNameCtr,sKey,sVal,pFunc){this._doUserCallBack(dnncore.SetUserVal,sNameCtr,sKey,sVal,new dnncore.UserPropArgs(sNameCtr,sKey,pFunc))},_doUserCallBack:function(iType,sNameCtr,sKey,sVal,pFunc){if(dnn&&dnn.xmlhttp){var sPack=iType+COL_DELIMITER+sNameCtr+COL_DELIMITER+sKey+COL_DELIMITER+sVal;dnn.xmlhttp.doCallBack("__Page",sPack,dnncore._callBackSuccess,pFunc,dnncore._callBackFail,null,!0,null,0)}else alert("Client Personalization not enabled")},_callBackSuccess:function(result,ctx,req){ctx.pFunc&&ctx.pFunc(ctx.namingCtr,ctx.key,result)},_callBackFail:function(result,ctx){window.status=result}},__dnncore.prototype.UserPropArgs=function(sNameCtr,sKey,pFunc){this.namingCtr=sNameCtr,this.key=sKey,this.pFunc=pFunc};var dnncore=new __dnncore;