function popupCal(){var popCalDateVal,tmpString=(new Date,""),tmpNum=0,dstWindowName="";if(popCalWin=new Object,arguments.length<2)return void alert("popupCal(): Wrong number of arguments.");dstWindowName=popupCal.arguments[0],popCalDstFld=popupCal.arguments[1],temp=popupCal.arguments[1],popCalDstFmt=popupCal.arguments[2],popCalMonths=popupCal.arguments[3],popCalDays=popupCal.arguments[4],popCalToday=popupCal.arguments[5],popCalClose=popupCal.arguments[6],popCalTitle=popupCal.arguments[7],popCalFirstDayWeek=popupCal.arguments[8],""!=popCalDstFld&&(popCalDstFld=document.getElementById(popCalDstFld)),""==popCalDstFmt&&(popCalDstFmt="m/d/yyyy"),""==popCalMonths&&(popCalMonths="January,February,March,April,May,June,July,August,September,October,November,December"),""==popCalDays&&(popCalDays="Sun,Mon,Tue,Wed,Thu,Fri,Sat"),""!=popCalToday&&"undefined"!=typeof popCalToday||(popCalToday="Today"),""!=popCalClose&&"undefined"!=typeof popCalClose||(popCalClose="Close"),""!=popCalTitle&&"undefined"!=typeof popCalTitle||(popCalTitle="Calendar"),tmpString=new String(popCalDstFld.value),""==tmpString?popCalDateVal=new Date:(tmpNum=tmpString.lastIndexOf("/"),tmpString.length-tmpNum==3?(tmpString=tmpString.substring(0,tmpNum+1)+"20"+tmpString.substr(tmpNum+1),popCalDateVal=new Date(tmpString)):popCalDateVal=getDateFromFormat(tmpString,popCalDstFmt)),"NaN"!=popCalDateVal.toString()&&"0"!=popCalDateVal.toString()||(popCalDateVal=new Date,popCalDstFld.value="");var dateString=String(popCalDateVal.getMonth()+1)+"/"+String(popCalDateVal.getDate())+"/"+String(popCalDateVal.getFullYear());reloadCalPopup(dateString,dstWindowName)}function closeCalPopup(){popCalWin.close()}function reloadCalPopup(){var windowFeatures="toolbar=no, location=no, status=no, menubar=no, scrollbars=no, resizable=no, height=270, width=270, top="+((screen.height-270)/2).toString()+",left="+((screen.width-270)/2).toString(),tmpDate=new Date(reloadCalPopup.arguments[0]);"Invalid Date"==tmpDate.toString()&&(tmpDate=new Date),tmpDate.setDate(1);var popCalData=calPopupSetData(tmpDate,reloadCalPopup.arguments[1]);"[object Object]"==popCalWin.toString()?(popCalWin=window.open("",reloadCalPopup.arguments[1],windowFeatures),popCalWin.opener=self,popCalWin.focus()):(popCalWin.document.close(),popCalWin.document.write("")),popCalWin.document.write(popCalData)}function calPopupSetData(firstDay,dstWindowName){var popCalData="",lastDate=0,fnt=new Array('<FONT SIZE="1">','<B><FONT SIZE="2">','<FONT SIZE="2" COLOR="#EF741D"><B>'),dtToday=new Date,thisMonth=firstDay.getMonth(),thisYear=firstDay.getFullYear(),nPrevMonth=0==thisMonth?11:thisMonth-1,nNextMonth=11==thisMonth?0:thisMonth+1,nPrevMonthYear=11==nPrevMonth?thisYear-1:thisYear,nNextMonthYear=0==nNextMonth?thisYear+1:thisYear,sToday=String(dtToday.getMonth()+1+"/01/"+dtToday.getFullYear()),sPrevMonth=String(nPrevMonth+1+"/01/"+nPrevMonthYear),sNextMonth=String(nNextMonth+1+"/01/"+nNextMonthYear),sPrevYear1=String(thisMonth+1+"/01/"+(thisYear-1)),sNextYear1=String(thisMonth+1+"/01/"+(thisYear+1)),tmpDate=new Date(sNextMonth);if(tmpDate=new Date(tmpDate.valueOf()-1001),lastDate=tmpDate.getDate(),this.popCalMonths.split)var monthNames=this.popCalMonths.split(","),dayNames=this.popCalDays.split(",");else var monthNames=new Array("January","February","March","April","May","June","July","August","September","October","November","December"),dayNames=new Array("Sun","Mon","Tue","Wed","Thu","Fri","Sat");var styles="<style><!-- body{font-family:Arial,Helvetica,sans-serif;font-size:9pt}; td {  font-family: Arial, Helvetica, sans-serif; font-size: 9pt; color: #666666}; A { text-decoration: none; };TD.day { border-bottom: solid black; border-width: 0px; }--></style>",cellAttribs='align="center" class="day" BGCOLOR="#F1F1F1"onMouseOver="temp=this.style.backgroundColor;this.style.backgroundColor=\'#CCCCCC\';" onMouseOut="this.style.backgroundColor=temp;"',cellAttribs2='align="center" BGCOLOR="#F1F1F1" onMouseOver="temp=this.style.backgroundColor;this.style.backgroundColor=\'#CCCCCC\';" onMouseOut="this.style.backgroundColor=temp;"',htmlHead="<HTML><HEAD><TITLE>"+popCalTitle+"</TITLE>"+styles+'</HEAD><BODY BGCOLOR="#F1F1F1" TEXT="#000000" LINK="#364180" ALINK="#FF8100" VLINK="#424282">',htmlTail="</BODY></HTML>",closeAnchor='<CENTER><input type=button value="'+popCalClose+'" onClick="javascript:window.opener.closeCalPopup()"></CENTER>',todayAnchor="<A HREF=\"javascript:window.opener.reloadCalPopup('"+sToday+"','"+dstWindowName+"');\">"+popCalToday+"</A>",prevMonthAnchor="<A HREF=\"javascript:window.opener.reloadCalPopup('"+sPrevMonth+"','"+dstWindowName+"');\">"+monthNames[nPrevMonth]+"</A>",nextMonthAnchor="<A HREF=\"javascript:window.opener.reloadCalPopup('"+sNextMonth+"','"+dstWindowName+"');\">"+monthNames[nNextMonth]+"</A>",prevYear1Anchor="<A HREF=\"javascript:window.opener.reloadCalPopup('"+sPrevYear1+"','"+dstWindowName+"');\">"+(thisYear-1)+"</A>",nextYear1Anchor="<A HREF=\"javascript:window.opener.reloadCalPopup('"+sNextYear1+"','"+dstWindowName+"');\">"+(thisYear+1)+"</A>";popCalData+=htmlHead+fnt[1],popCalData+='<DIV align="center">',popCalData+='<TABLE BORDER="0" cellspacing="0" callpadding="0" width="250"><TR><TD width="45">&nbsp</TD>',popCalData+='<TD width="45" align="center" '+cellAttribs2,popCalData+=" >",popCalData+=fnt[0]+prevYear1Anchor+"</FONT></TD>",popCalData+='<TD width="70" align="center" '+cellAttribs2,popCalData+=" >",popCalData+=fnt[0]+todayAnchor+"</FONT></TD>",popCalData+='<TD width="45" align="center" '+cellAttribs2,popCalData+=" >",popCalData+=fnt[0]+nextYear1Anchor+'</FONT></TD><TD width="45">&nbsp</TD>',popCalData+="</TR></TABLE>",popCalData+='<TABLE BORDER="0" cellspacing="0" callpadding="0" width="250">',popCalData+='<TR><TD width="55" align="center" '+cellAttribs2,popCalData+=" >",popCalData+=fnt[0]+prevMonthAnchor+"</FONT></TD>",popCalData+='<TD width="140" align="center">',popCalData+="&nbsp;&nbsp;"+fnt[1]+'<FONT COLOR="#000000">'+monthNames[thisMonth]+", "+thisYear+"&nbsp;&nbsp;</FONT></TD>",popCalData+='<TD width="55" align="center" '+cellAttribs2,popCalData+=" >",popCalData+=fnt[0]+nextMonthAnchor+"</FONT></TD></TR></TABLE><BR>",popCalData+='<TABLE BORDER="0" cellspacing="2" cellpadding="1"  width="245">',popCalData+="",popCalData+="<TR>";var xday=0;for(xday=0;xday<7;xday++)popCalData+='<TD width="35" align="center">'+fnt[1]+'<FONT COLOR="#000000">'+dayNames[(xday+popCalFirstDayWeek)%7]+"</FONT></TD>";popCalData+="</TR>";var calDay=0,monthDate=1,weekDay=firstDay.getDay();do{for(popCalData+="<TR>",calDay=0;calDay<7;calDay++)(weekDay+7-popCalFirstDayWeek)%7!=calDay||monthDate>lastDate?popCalData+='<TD width="35">'+fnt[1]+"&nbsp;</FONT></TD>":(anchorVal="<A HREF=\"javascript:window.opener.calPopupSetDate(window.opener.popCalDstFld,'"+constructDate(monthDate,thisMonth+1,thisYear)+"');window.opener.closeCalPopup()\">",jsVal="javascript:window.opener.calPopupSetDate(window.opener.popCalDstFld,'"+constructDate(monthDate,thisMonth+1,thisYear)+"');window.opener.closeCalPopup()",popCalData+='<TD width="35" '+cellAttribs+' onClick="'+jsVal+'">',popCalData+=firstDay.getMonth()==dtToday.getMonth()&&monthDate==dtToday.getDate()&&thisYear==dtToday.getFullYear()?anchorVal+fnt[2]+monthDate+"</A></FONT></TD>":anchorVal+fnt[1]+monthDate+"</A></FONT></TD>",weekDay++,monthDate++);weekDay=popCalFirstDayWeek,popCalData+="</TR>"}while(monthDate<=lastDate);return popCalData+="</TABLE></DIV><BR>",popCalData+=closeAnchor+"</FONT>"+htmlTail}function calPopupSetDate(){calPopupSetDate.arguments[0].value=calPopupSetDate.arguments[1]}function padZero(num){return num<=9?"0"+num:num}function constructDate(d,m,y){var fmtDate=this.popCalDstFmt;return fmtDate=fmtDate.replace("dd",padZero(d)),fmtDate=fmtDate.replace("d",d),fmtDate=fmtDate.replace("MM",padZero(m)),fmtDate=fmtDate.replace("M",m),fmtDate=fmtDate.replace("yyyy",y),fmtDate=fmtDate.replace("yy",padZero(y%100))}function _isInteger(val){for(var digits="1234567890",i=0;i<val.length;i++)if(digits.indexOf(val.charAt(i))==-1)return!1;return!0}function _getInt(str,i,minlength,maxlength){for(var x=maxlength;x>=minlength;x--){var token=str.substring(i,i+x);if(token.length<minlength)return null;if(_isInteger(token))return token}return null}function getDateFromFormat(val,format){val+="",format+="";for(var x,y,i_val=0,i_format=0,c="",token="",now=new Date,year=now.getYear(),month=now.getMonth()+1,date=1;i_format<format.length;){for(c=format.charAt(i_format),token="";format.charAt(i_format)==c&&i_format<format.length;)token+=format.charAt(i_format++);if("yyyy"==token||"yy"==token||"y"==token){if("yyyy"==token&&(x=4,y=4),"yy"==token&&(x=2,y=2),"y"==token&&(x=2,y=4),year=_getInt(val,i_val,x,y),null==year)return 0;i_val+=year.length,2==year.length&&(year=year>70?1900+(year-0):2e3+(year-0))}else if("MM"==token||"M"==token){if(month=_getInt(val,i_val,token.length,2),null==month||month<1||month>12)return 0;i_val+=month.length}else if("dd"==token||"d"==token){if(date=_getInt(val,i_val,token.length,2),null==date||date<1||date>31)return 0;i_val+=date.length}else{if(val.substring(i_val,i_val+token.length)!=token)return 0;i_val+=token.length}}if(i_val!=val.length)return 0;if(2==month)if(year%4==0&&year%100!=0||year%400==0){if(date>29)return 0}else if(date>28)return 0;if((4==month||6==month||9==month||11==month)&&date>30)return 0;var newdate=new Date(year,month-1,date);return newdate}var popCalDstFld,temp,popCalWin;"undefined"!=typeof Sys&&Sys.Application.notifyScriptLoaded();