var hcc=hcc||{};!function($){hcc.vars=null,hcc.config=hcc.config||{},hcc.getVars=function(){if(null==hcc.vars){var jsonValue=$("#__hccVariables").val();jsonValue?hcc.vars=jQuery.parseJSON(jsonValue):hcc.vars=[]}return hcc.vars},hcc.getVar=function(key,def){return null!=hcc.getVars()[key]?hcc.getVars()[key]:def},hcc.getSiteRoot=function(){return dnn&&dnn.getVar?dnn.getVar("hc_siteRoot","/"):hcc.getVar("hc_siteRoot","/")},hcc.getResourceUrl=function(path){var resourceUrl=hcc.getSiteRoot();return resourceUrl+="DesktopModules/Hotcakes/Core/"+path},hcc.getServiceUrl=function(path){var serviceUrl=hcc.getSiteRoot();return serviceUrl+="DesktopModules/Hotcakes/API/mvc/"+path},hcc.formIsValid=function($form){var validator=$.data($form[0],"validator");return!(validator&&!validator.form())},hcc.getUrlVar=function(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+name+"=([^&#]*)"),results=regex.exec(location.search);return null===results?"":decodeURIComponent(results[1].replace(/\+/g," "))},hcc.autoHeight=function(className){$(window).resize(function(){onresize(className)});var onresize=function(){$(className).each(function(i,e){var $el=$(e);$el.height(.7*$el.width()),$el.find("img").height(.7*$el.width())})};setTimeout(onresize,10)},$.xhrPool=[],$.xhrPool.abortAll=function(){$(this).each(function(i,jqXHR){jqXHR.abort(),$.xhrPool.splice(i,1)})},$.ajaxSetup({beforeSend:function(jqXHR){$.xhrPool.push(jqXHR)},complete:function(jqXHR){var i=$.xhrPool.indexOf(jqXHR);i>-1&&$.xhrPool.splice(i,1)}}),$.fn.ajaxLoader=function(type,options){var defaults={bgColor:"#fff",duration:300,opacity:.5};this.container=this,this.init=function(element,options){var container=this.container;this.remove();var overlay=$("<div></div>").css({"background-color":this.options.bgColor,opacity:this.options.opacity,width:container.width(),height:container.height(),position:"absolute",top:"0px",left:"0px","z-index":99999}).addClass("ajax_overlay");this.options.classOveride&&overlay.addClass(this.options.classOveride),"absolute"!=container.css("position")&&container.css("position","relative"),container.append(overlay.append($("<div></div>").addClass("hcAjaxLoader")).fadeIn(this.options.duration))},this.remove=function(){var overlay=this.container.children(".ajax_overlay");overlay.length&&overlay.remove()},"stop"!=type?(this.options=jQuery.extend(defaults,options),this.init(this,options)):this.remove()},$.fn.hcDialog=function(options){if("close"==options||"open"==options)$(this).dialog(options);else{var defaults={width:$(this).data("width"),height:$(this).data("height"),minWidth:$(this).data("minWidth"),minHeight:$(this).data("minHeight"),maxWidth:$(this).data("maxWidth"),maxHeight:$(this).data("maxHeight"),title:$(this).data("title"),autoOpen:!0,dialogClass:hcc.config.dialogClass},fakeForm=$(this).closest('div[data-type="form"]');defaults.parentElement=fakeForm.length?fakeForm:$("form"),options=$.extend(defaults,options),$(this).dialog({width:options.width,height:options.height,minWidth:options.minWidth,minHeight:options.minHeight,maxWidth:options.maxWidth,maxHeight:options.maxHeight,title:options.title,modal:!1,autoOpen:options.autoOpen,closeOnEscape:!0,position:"center",dialogClass:options.dialogClass,open:function(event,ui){$(".ui-widget-overlay").remove();var $overlay=$("<div/>").addClass("ui-widget-overlay");$overlay.css("position","fixed"),$overlay.css("z-index","1000"),$overlay.appendTo(options.parentElement),$(this).parent().appendTo(options.parentElement);var $dialog=$(this).parent();$dialog.css("position","fixed"),$dialog.css("z-index","1001");var top=($(window).height()-$dialog.height())/2;top<10&&(top=10,$dialog.find(".ui-dialog-content").height($(window).height()-150).css("overflow","auto")),$dialog.css("top",top),options.maxHeight&&$dialog.find(".ui-dialog-content").css("max-height",options.maxHeight),options.open&&options.open()},close:function(){options.close&&options.close(),$(".ui-widget-overlay").remove()}})}},$.fn.scrollTo=function(target,options){var settings=$.extend({scrollTarget:target,offsetTop:50,duration:500},options);return this.each(function(){$(this).animate({scrollTop:$(target).offset().top-settings.offsetTop},parseInt(settings.duration))})},$.fn.hcCardInput=function(iconsSelector,cleanNumberCallback){function CardInput(el){this.$el=$(el),this.init()}var $icons=$(iconsSelector);return CardInput.prototype={init:function(){var $el=this.$el,self=this;$el.change(function(){cleanNumberCallback($el)}),$el.keyup(function(){self.changeIcons()})},changeIcons:function(){var cc=this.getCardType(this.$el.val());""!=cc?($icons.find("span").addClass("cc-disabled"),$icons.find(".cc-"+cc).removeClass("cc-disabled")):$icons.find("span").removeClass("cc-disabled")},getCardType:function(number){var re=new RegExp("^4");return null!=number.match(re)?"visa":(re=new RegExp("^(34|37)"),null!=number.match(re)?"amex":(re=new RegExp("^5[1-5]"),null!=number.match(re)?"mastercard":(re=new RegExp("^6011"),null!=number.match(re)?"discover":(re=new RegExp("^(30|38)"),null!=number.match(re)?"diners":(re=new RegExp("^35"),null!=number.match(re)?"jcb":"")))))}},this.each(function(){$.data(this,"plugin_hcCardInput")||$.data(this,"plugin_hcCardInput",new CardInput(this))})}}(jQuery);