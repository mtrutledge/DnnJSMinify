!function(){function p(t,s){for(;t&&(8===t.nodeType||3===t.nodeType&&/^[ \t\n\r]*$/.test(t.nodeValue));)t=s(t);return t}function b(s){return p(s,function(t){return t.previousSibling})}function i(s){return p(s,function(t){return t.nextSibling})}function d(s,u,t){return s.dom.getParent(u,function(v){return tinymce.inArray(t,v)!==-1})}function n(s){return s&&("OL"===s.tagName||"UL"===s.tagName)}function c(u,v){var t,w,s;for(t=b(u.lastChild);n(t);)w=t,t=b(w.previousSibling);return w&&(s=v.create("li",{style:"list-style-type: none;"}),v.split(u,w),v.insertAfter(s,w),s.appendChild(w),s.appendChild(w),u=s.previousSibling),u}function m(t,s,u){return t=a(t,s,u),o(t,s,u)}function a(u,s,v){var t=b(u.previousSibling);return t?h(t,u,!!s&&t,v):u}function o(u,t,v){var s=i(u.nextSibling);return s?h(u,s,!!t&&s,v):u}function h(u,s,t,v){return l(u,s,!!t,v)?f(u,s,t):(u&&"LI"===u.tagName&&n(s)&&u.appendChild(s),s)}function l(u,t,s,v){return!(!u||!t)&&("LI"===u.tagName&&"LI"===t.tagName?"none"===t.style.listStyleType||j(t):n(u)?u.tagName===t.tagName&&(s||u.style.listStyleType===t.style.listStyleType)||q(t):v&&"P"===u.tagName&&"P"===t.tagName)}function q(t){var s=i(t.firstChild),u=b(t.lastChild);return s&&u&&n(t)&&s===u&&(n(s)||"none"===s.style.listStyleType||j(s))}function j(u){var t=i(u.firstChild),s=b(u.lastChild);return t&&s&&t===s&&n(t)}function f(w,v,s){var u=b(w.lastChild),t=i(v.firstChild);for("P"===w.tagName&&w.appendChild(w.ownerDocument.createElement("br"));v.firstChild;)w.appendChild(v.firstChild);return s&&(w.style.listStyleType=s.style.listStyleType),v.parentNode.removeChild(v),h(u,t,!1),w}function k(t,u){var s;return u.is(t,"li,ol,ul")||(s=u.getParent(t,"li"),s&&(t=s)),t}var g,e=tinymce.each,r=tinymce.dom.Event;tinymce.create("tinymce.plugins.Lists",{init:function(y){function E(U){return U.keyCode===tinymce.VK.TAB&&!(U.altKey||U.ctrlKey)&&(y.queryCommandState("InsertUnorderedList")||y.queryCommandState("InsertOrderedList"))}function w(){var U=B(),W=U.parentNode.parentNode,V=U.parentNode.lastChild===U;return V&&!t(W)&&P(U)}function t(U){return n(U)?U.parentNode&&"LI"===U.parentNode.tagName:"LI"===U.tagName}function F(){return y.selection.isCollapsed()&&P(B())}function B(){var U=y.selection.getStart();return"BR"!=U.tagName&&""!=U.tagName||"LI"!=U.parentNode.tagName?U:U.parentNode}function P(U){var V=U.childNodes.length;return"LI"===U.tagName&&(0==V||1==V&&(""==U.firstChild.tagName||"BR"==U.firstChild.tagName||H(U)))}function H(U){var V=tinymce.grep(U.parentNode.childNodes,function(Y){return"LI"==Y.tagName}),W=U==V[V.length-1],X=U.firstChild;return tinymce.isIE9&&W&&(X.nodeValue==String.fromCharCode(160)||X.nodeValue==String.fromCharCode(32))}function T(U){return U.keyCode===tinymce.VK.ENTER}function A(U){return T(U)&&!U.shiftKey}function M(U){return E(U)?v:A(U)&&w()?N:A(U)&&F()?s:N}function D(U,V){(x==v||x==s||tinymce.isGecko&&x==J)&&r.cancel(V)}function C(){var U=y.selection.getRng(!0),V=U.startContainer;if(3==V.nodeType){var W=V.nodeValue;return tinymce.isIE9&&W.length>1&&32==W.charCodeAt(W.length-1)?U.endOffset==W.length-1:U.endOffset==W.length}return 1==V.nodeType&&U.endOffset==V.childNodes.length}function I(){var W=y.selection.getNode(),V="h1,h2,h3,h4,h5,h6,p,div",U=y.dom.is(W,V)&&"LI"===W.parentNode.tagName&&W.parentNode.lastChild===W;return y.selection.isCollapsed()&&U&&C()}function K(W,Y){if(A(Y)&&I()){var X=W.selection.getNode(),V=W.dom.create("li"),U=W.dom.getParent(X,"li");W.dom.insertAfter(V,U),tinymce.isIE6||tinymce.isIE7||tinyMCE.isIE8?W.selection.setCursorLocation(V,1):W.selection.setCursorLocation(V,0),Y.preventDefault()}}function u(X,Z){function W(ag){var ah=ag.firstChild,af=null;do{if(!ah)break;"LI"===ah.tagName&&(af=ah)}while(ah=ah.nextSibling);return af}function ae(ag,af){for(;ag.childNodes.length>0;)af.appendChild(ag.childNodes[0])}var ac;if(tinymce.isGecko){var V=X.selection.getStart();if(Z.keyCode==tinymce.VK.BACKSPACE&&"IMG"===V.tagName&&(ac=V.parentNode.previousSibling)){var aa;if("UL"===ac.tagName||"OL"===ac.tagName)aa=ac;else{if(!ac.previousSibling||"UL"!==ac.previousSibling.tagName&&"OL"!==ac.previousSibling.tagName)return;aa=ac.previousSibling}var ad=W(aa),U=X.dom.createRng();U.setStart(ad,1),U.setEnd(ad,1),X.selection.setRng(U),X.selection.collapse(!0);var Y=X.selection.getBookmark(),ab=V.parentNode.cloneNode(!0);"P"===ab.tagName||"DIV"===ab.tagName?ae(ab,ad):ad.appendChild(ab),V.parentNode.parentNode.removeChild(V.parentNode),X.selection.moveToBookmark(Y)}}}function G(U){var V=y.dom.getParent(U,"ol,ul");if(null!=V){var W=V.lastChild;y.selection.setCursorLocation(W,0)}}function L(V,U){var W=y.getDoc().createTextNode("\ufeff");V.insertBefore(W,U),y.selection.setCursorLocation(W,0),y.execCommand("mceRepaint")}function R(V,X){if(T(X)){var U=B();if(U){var W=U.parentNode,Y=W&&W.parentNode;Y&&"LI"==Y.nodeName&&Y.firstChild==W&&U==W.firstChild&&L(Y,W)}}}function S(V,X){if(T(X)){var U=B();if(1===V.dom.select("ul li",U).length){var W=U.firstChild;L(U,W)}}}function Q(W,aa){function X(ab){for(var ad=[],ae=new tinymce.dom.TreeWalker(ab.firstChild,ab),ac=ae.current();ac;ac=ae.next())W.dom.is(ac,"ol,ul,li")&&ad.push(ac);return ad}if(aa.keyCode==tinymce.VK.BACKSPACE){var U=B();if(U){var Z=W.dom.getParent(U,"ol,ul"),V=W.selection.getRng();if(Z&&Z.firstChild===U&&0==V.startOffset){var Y=X(U);return Y.unshift(U),W.execCommand("Outdent",!1,Y),W.undoManager.add(),r.cancel(aa)}}}}function O(V,X){var U=B();if(X.keyCode===tinymce.VK.BACKSPACE&&V.dom.is(U,"li")&&U.parentNode.firstChild!==U&&1===V.dom.select("ul,ol",U).length){var Z=U.previousSibling;V.dom.remove(V.dom.select("br",U)),V.dom.remove(U,!0);var W=tinymce.grep(Z.childNodes,function(aa){return 3===aa.nodeType});if(1===W.length){var Y=W[0];V.selection.setCursorLocation(Y,Y.length)}return V.undoManager.add(),r.cancel(X)}}var v="TABBING",s="EMPTY",J="ESCAPE",N="UNKNOWN",x=N;this.ed=y,y.addCommand("Indent",this.indent,this),y.addCommand("Outdent",this.outdent,this),y.addCommand("InsertUnorderedList",function(){this.applyList("UL","OL")},this),y.addCommand("InsertOrderedList",function(){this.applyList("OL","UL")},this),y.onInit.add(function(){y.editorCommands.addCommands({outdent:function(){function U(X){return X=W.getParent(X,W.isBlock),X&&parseInt(y.dom.getStyle(X,"margin-left")||0,10)+parseInt(y.dom.getStyle(X,"padding-left")||0,10)>0}var V=y.selection,W=y.dom;return U(V.getStart())||U(V.getEnd())||y.queryCommandState("InsertOrderedList")||y.queryCommandState("InsertUnorderedList")}},"state")}),y.onKeyUp.add(function(V,W){if(x==v)return V.execCommand(W.shiftKey?"Outdent":"Indent",!0,null),x=N,r.cancel(W);if(x==s){var U=B(),Y=V.settings.list_outdent_on_enter===!0||W.shiftKey;return V.execCommand(Y?"Outdent":"Indent",!0,null),tinymce.isIE&&G(U),r.cancel(W)}if(x==J)if(tinymce.isIE6||tinymce.isIE7||tinymce.isIE8){var X=V.getDoc().createTextNode("\ufeff");V.selection.getNode().appendChild(X)}else if(tinymce.isIE9||tinymce.isGecko)return V.execCommand("Outdent"),r.cancel(W)}),y.onKeyDown.add(function(U,V){x=M(V)}),y.onKeyDown.add(D),y.onKeyDown.add(u),y.onKeyDown.add(K),tinymce.isGecko&&y.onKeyUp.add(R),tinymce.isIE8&&y.onKeyUp.add(S),(tinymce.isGecko||tinymce.isWebKit)&&y.onKeyDown.add(Q),tinymce.isWebKit&&y.onKeyDown.add(O)},applyList:function(y,v){function E(t){t&&"BR"===t.tagName&&I.remove(t)}function F(M){function L(O){(O.style.marginLeft||O.style.paddingLeft)&&C.adjustPaddingFunction(!1)(O)}var t,N=I.create(y);if("LI"===M.tagName);else{if("P"===M.tagName||"DIV"===M.tagName||"BODY"===M.tagName)return K(M,function(P,O){J(P,O,"BODY"===M.tagName?null:P.parentNode),t=P.parentNode,L(t),E(O)}),void(t&&("LI"===t.tagName&&("P"===M.tagName||G.length>1)&&I.split(t.parentNode.parentNode,t.parentNode),m(t.parentNode,!0)));t=I.create("li"),I.insertAfter(t,M),t.appendChild(M),L(M),M=t}I.insertAfter(N,M),N.appendChild(M),m(N,!0),s.push(M)}function J(P,L,N){for(var t,M,O=P;!I.isBlock(P.parentNode)&&P.parentNode!==I.getRoot();)P=I.split(P.parentNode,P.previousSibling),P=P.nextSibling,O=P;if(N){for(t=N.cloneNode(!0),P.parentNode.insertBefore(t,P);t.firstChild;)I.remove(t.firstChild);t=I.rename(t,"li")}else t=I.create("li"),P.parentNode.insertBefore(t,P);for(;O&&O!=L;)M=O.nextSibling,t.appendChild(O),O=M;0===t.childNodes.length&&(t.innerHTML='<br _mce_bogus="1" />'),F(t)}function K(Q,T){function P(X,U){var W,V=I.createRng();return g.keep=!0,z.selection.moveToBookmark(g),g.keep=!1,W=z.selection.getRng(!0),U||(U=X.parentNode.lastChild),V.setStartBefore(X),V.setEndAfter(U),!(V.compareBoundaryPoints(O,W)>0||V.compareBoundaryPoints(L,W)<=0)}function S(U){return U.nextSibling?U.nextSibling:I.isBlock(U.parentNode)||U.parentNode===I.getRoot()?void 0:S(U.parentNode)}var N,R,O=3,L=1,t="br,ul,ol,p,div,h1,h2,h3,h4,h5,h6,table,blockquote,address,pre,form,center,dl";N=Q.firstChild;var M=!1;e(I.select(t,Q),function(U){return!(!U.hasAttribute||!U.hasAttribute("_mce_bogus"))||void(P(N,U)&&(I.addClass(U,"_mce_tagged_br"),N=S(U)))}),M=N&&P(N,void 0),N=Q.firstChild,e(I.select(t,Q),function(V){var U=S(V);return!(!V.hasAttribute||!V.hasAttribute("_mce_bogus"))||(I.hasClass(V,"_mce_tagged_br")?(T(N,V,R),R=null):R=V,void(N=U))}),M&&T(N,void 0,R)}function D(t){K(t,function(M,L,N){J(M,L),E(L),E(N)})}function A(t){tinymce.inArray(s,t)===-1&&(t.parentNode.tagName===v&&(I.split(t.parentNode,t),F(t),o(t.parentNode,!1)),s.push(t))}function x(M){var O,N,L,t;if(tinymce.inArray(s,M)===-1){for(M=c(M,I);I.is(M.parentNode,"ol,ul,li");)I.split(M.parentNode,M);if(s.push(M),M=I.rename(M,"p"),L=m(M,!1,z.settings.force_br_newlines),L===M)for(O=M.firstChild;O;)I.isBlock(O)?(O=I.split(O.parentNode,O),t=!0,N=O.nextSibling&&O.nextSibling.firstChild):(N=O.nextSibling,t&&"BR"===O.tagName&&I.remove(O),t=!1),O=N}}var B,C=this,z=C.ed,I=z.dom,s=[],H=!1,u=!1,w=!1,G=z.selection.getSelectedBlocks();e(G,function(t){t=k(t,I),t.tagName===v||"LI"===t.tagName&&t.parentNode.tagName===v?u=!0:t.tagName===y||"LI"===t.tagName&&t.parentNode.tagName===y?H=!0:w=!0}),B=w&&!H||u||0===G.length?{LI:A,H1:F,H2:F,H3:F,H4:F,H5:F,H6:F,P:F,BODY:F,DIV:G.length>1?F:D,defaultAction:D,elements:this.selectedBlocks()}:{defaultAction:x,elements:this.selectedBlocks(),processEvenIfEmpty:!0},this.process(B)},indent:function(){function s(z){var y=w.create("li",{style:"list-style-type: none;"});return w.insertAfter(y,z),y}function t(B){var z,y=s(B),D=w.getParent(B,"ol,ul"),C=D.tagName,E=w.getStyle(D,"list-style-type"),A={};return""!==E&&(A.style="list-style-type: "+E+";"),z=w.create(C,A),y.appendChild(z),z}function v(z){if(!d(u,z,x)){z=c(z,w);var y=t(z);y.appendChild(z),m(y.parentNode,!1),m(y,!1),x.push(z)}}var u=this.ed,w=u.dom,x=[];this.process({LI:v,defaultAction:this.adjustPaddingFunction(!0),elements:this.selectedBlocks()})},outdent:function(y,x){function A(t){var C,B,D;if(!d(u,t,s)){if(""!==z.getStyle(t,"margin-left")||""!==z.getStyle(t,"padding-left"))return w.adjustPaddingFunction(!1)(t);if(D=z.getStyle(t,"text-align",!0),"center"===D||"right"===D)return void z.setStyle(t,"text-align","left");t=c(t,z),C=t.parentNode,B=t.parentNode.parentNode,"P"===B.tagName?z.split(B,t.parentNode):(z.split(C,t),"LI"===B.tagName?z.split(B,t):z.is(B,"ol,ul")||z.rename(t,"p")),s.push(t)}}var w=this,u=w.ed,z=u.dom,s=[],v=x&&tinymce.is(x,"array")?x:this.selectedBlocks();this.process({LI:A,defaultAction:this.adjustPaddingFunction(!1),elements:v}),e(s,m)},process:function(y){function B(t){var s=tinymce.grep(t.childNodes,function(H){return!("BR"===H.nodeName||"SPAN"===H.nodeName&&"bookmark"==z.getAttrib(H,"data-mce-type")||3==H.nodeType&&(H.nodeValue==String.fromCharCode(160)||""==H.nodeValue))});return 0===s.length}function x(s){if(z.removeClass(s,"_mce_act_on"),s&&1===s.nodeType&&!(!y.processEvenIfEmpty&&E.length>1&&B(s))){s=k(s,z);var t=y[s.tagName];t||(t=y.defaultAction),t(s)}}function v(s){F.splitSafeEach(s.childNodes,x,!0)}function C(s,t){return t>=0&&s.hasChildNodes()&&t<s.childNodes.length&&"BR"===s.childNodes[t].tagName}function D(){var t=w.getNode(),s=z.getParent(t,"td");return null!==s}var E,u,F=this,w=F.ed.selection,z=F.ed.dom;if(E=y.elements,u=w.getRng(!0),u.collapsed||(C(u.endContainer,u.endOffset-1)&&(u.setEnd(u.endContainer,u.endOffset-1),w.setRng(u)),C(u.startContainer,u.startOffset)&&(u.setStart(u.startContainer,u.startOffset+1),w.setRng(u))),tinymce.isIE8){var G=F.ed.selection.getNode();if("LI"===G.tagName&&G.parentNode.lastChild!==G){var A=F.ed.getDoc().createTextNode("\ufeff");G.appendChild(A)}}g=w.getBookmark(),y.OL=y.UL=v,F.splitSafeEach(E,x),w.moveToBookmark(g),g=null,D()||F.ed.execCommand("mceRepaint")},splitSafeEach:function(u,t,s){s||tinymce.isGecko&&(/Firefox\/[12]\.[0-9]/.test(navigator.userAgent)||/Firefox\/3\.[0-4]/.test(navigator.userAgent))?this.classBasedEach(u,t):e(u,t)},classBasedEach:function(v,u){var s,t,w=this.ed.dom;for(e(v,function(x){w.addClass(x,"_mce_act_on")}),s=w.select("._mce_act_on");s.length>0;)t=s.shift(),w.removeClass(t,"_mce_act_on"),u(t),s=w.select("._mce_act_on")},adjustPaddingFunction:function(u){var s,v,t=this.ed;return s=t.settings.indentation,v=/[a-z%]+/i.exec(s),s=parseInt(s,10),function(w){var y,x;y=parseInt(t.dom.getStyle(w,"margin-left")||0,10)+parseInt(t.dom.getStyle(w,"padding-left")||0,10),x=u?y+s:y-s,t.dom.setStyle(w,"padding-left",""),t.dom.setStyle(w,"margin-left",x>0?x+v:"")}},selectedBlocks:function(){var s=this.ed,t=s.selection.getSelectedBlocks();return 0==t.length?[s.dom.getRoot()]:t},getInfo:function(){return{longname:"Lists",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/lists",version:tinymce.majorVersion+"."+tinymce.minorVersion}}}),tinymce.PluginManager.add("lists",tinymce.plugins.Lists)}();