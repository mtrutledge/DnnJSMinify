!function(){function b(d,e){return d.getParam(e,a[e])}var c=tinymce.each,a={paste_auto_cleanup_on_paste:!0,paste_enable_default_filters:!0,paste_block_drop:!1,paste_retain_style_properties:"none",paste_strip_class_attributes:"mso",paste_remove_spans:!1,paste_remove_styles:!1,paste_remove_styles_if_webkit:!0,paste_convert_middot_lists:!0,paste_convert_headers_to_strong:!1,paste_dialog_width:"450",paste_dialog_height:"400",paste_max_consecutive_linebreaks:2,paste_text_use_dialog:!1,paste_text_sticky:!1,paste_text_sticky_default:!1,paste_text_notifyalways:!1,paste_text_linebreaktype:"combined",paste_text_replacements:[[/\u2026/g,"..."],[/[\x93\x94\u201c\u201d]/g,'"'],[/[\x60\x91\x92\u2018\u2019]/g,"'"]]};tinymce.create("tinymce.plugins.PastePlugin",{init:function(d,e){function h(l,j){var i,k=d.dom;f.onPreProcess.dispatch(f,l),l.node=k.create("div",0,l.content),tinymce.isGecko&&(i=d.selection.getRng(!0),i.startContainer==i.endContainer&&3==i.startContainer.nodeType&&1===l.node.childNodes.length&&/^(p|h[1-6]|pre)$/i.test(l.node.firstChild.nodeName)&&l.content.indexOf("__MCE_ITEM__")===-1&&k.remove(l.node.firstChild,!0)),f.onPostProcess.dispatch(f,l),l.content=d.serializer.serialize(l.node,{getInner:1,forced_root_block:""}),!j&&d.pasteAsPlainText?(f._insertPlainText(l.content),b(d,"paste_text_sticky")||(d.pasteAsPlainText=!1,d.controlManager.setActive("pastetext",!1))):f._insert(l.content)}function g(s){function m(n){n.preventDefault()}var l,p,j,t,i,r,k=d.selection,o=d.dom,q=d.getBody();if((s.clipboardData||o.doc.dataTransfer)&&(r=(s.clipboardData||o.doc.dataTransfer).getData("Text"),d.pasteAsPlainText))return s.preventDefault(),void h({content:o.encode(r).replace(/\r?\n/g,"<br />")});if(!o.get("_mcePaste"))return l=o.add(q,"div",{id:"_mcePaste",class:"mcePaste","data-mce-bogus":"1"},"\ufeff\ufeff"),i=q!=d.getDoc().body?o.getPos(d.selection.getStart(),q).y:q.scrollTop+o.getViewPort(d.getWin()).y,o.setStyles(l,{position:"absolute",left:tinymce.isGecko?-40:0,top:i-25,width:1,height:1,overflow:"hidden"}),tinymce.isIE?(t=k.getRng(),j=o.doc.body.createTextRange(),j.moveToElementText(l),j.execCommand("Paste"),o.remove(l),"\ufeff\ufeff"===l.innerHTML?(d.execCommand("mcePasteWord"),void s.preventDefault()):(k.setRng(t),k.setContent(""),setTimeout(function(){h({content:l.innerHTML})},0),tinymce.dom.Event.cancel(s))):(o.bind(d.getDoc(),"mousedown",m),o.bind(d.getDoc(),"keydown",m),p=d.selection.getRng(),l=l.firstChild,j=d.getDoc().createRange(),j.setStart(l,0),j.setEnd(l,2),k.setRng(j),window.setTimeout(function(){var n,u="";o.select("div.mcePaste > div.mcePaste").length?u="<p>"+o.encode(r).replace(/\r?\n\r?\n/g,"</p><p>").replace(/\r?\n/g,"<br />")+"</p>":(n=o.select("div.mcePaste"),c(n,function(w){var v=w.firstChild;v&&"DIV"==v.nodeName&&v.style.marginTop&&v.style.backgroundColor&&o.remove(v,1),c(o.select("span.Apple-style-span",w),function(x){o.remove(x,1)}),c(o.select("br[data-mce-bogus]",w),function(x){o.remove(x)}),"mcePaste"!=w.parentNode.className&&(u+=w.innerHTML)})),c(o.select("div.mcePaste"),function(v){o.remove(v)}),p&&k.setRng(p),h({content:u}),o.unbind(d.getDoc(),"mousedown",m),o.unbind(d.getDoc(),"keydown",m)},0),void 0)}var f=this;f.editor=d,f.url=e,f.onPreProcess=new tinymce.util.Dispatcher(f),f.onPostProcess=new tinymce.util.Dispatcher(f),f.onPreProcess.add(f._preProcess),f.onPostProcess.add(f._postProcess),f.onPreProcess.add(function(i,j){d.execCallback("paste_preprocess",i,j)}),f.onPostProcess.add(function(i,j){d.execCallback("paste_postprocess",i,j)}),d.onKeyDown.addToTop(function(i,j){if((tinymce.isMac?j.metaKey:j.ctrlKey)&&86==j.keyCode||j.shiftKey&&45==j.keyCode)return!1}),d.pasteAsPlainText=b(d,"paste_text_sticky_default"),d.addCommand("mceInsertClipboardContent",function(i,j){h(j,!0)}),b(d,"paste_text_use_dialog")||d.addCommand("mcePasteText",function(j,i){var k=tinymce.util.Cookie;d.pasteAsPlainText=!d.pasteAsPlainText,d.controlManager.setActive("pastetext",d.pasteAsPlainText),d.pasteAsPlainText&&!k.get("tinymcePasteText")&&(b(d,"paste_text_sticky")?d.windowManager.alert(d.translate("paste.plaintext_mode_sticky")):d.windowManager.alert(d.translate("paste.plaintext_mode")),b(d,"paste_text_notifyalways")||k.set("tinymcePasteText","1",new Date((new Date).getFullYear()+1,12,31)))}),d.addButton("pastetext",{title:"paste.paste_text_desc",cmd:"mcePasteText"}),d.addButton("selectall",{title:"paste.selectall_desc",cmd:"selectall"}),b(d,"paste_auto_cleanup_on_paste")&&(tinymce.isOpera||/Firefox\/2/.test(navigator.userAgent)?d.onKeyDown.addToTop(function(i,j){((tinymce.isMac?j.metaKey:j.ctrlKey)&&86==j.keyCode||j.shiftKey&&45==j.keyCode)&&g(j)}):d.onPaste.addToTop(function(i,j){return g(j)})),d.onInit.add(function(){d.controlManager.setActive("pastetext",d.pasteAsPlainText),b(d,"paste_block_drop")&&d.dom.bind(d.getBody(),["dragend","dragover","draggesture","dragdrop","drop","drag"],function(i){return i.preventDefault(),i.stopPropagation(),!1})}),f._legacySupport()},getInfo:function(){return{longname:"Paste text/word",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/paste",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_preProcess:function(g,e){function d(h){c(h,function(o){j=o.constructor==RegExp?j.replace(o,""):j.replace(o[0],o[1])})}function m(q,o){if("all"===i)return"";var h=p(n(o.replace(/^(["'])(.*)\1$/,"$2")," "),function(r){return/^(?!mso)/i.test(r)});return h.length?' class="'+h.join(" ")+'"':""}var l,i,k=this.editor,j=e.content,p=tinymce.grep,n=tinymce.explode,f=tinymce.trim;if(0!=k.settings.paste_enable_default_filters){if(tinymce.isIE&&document.documentMode>=9&&/<(h[1-6r]|p|div|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|blockquote|center|dl|dt|dd|dir|fieldset)/.test(e.content)&&(d([[/(?:<br>&nbsp;[\s\r\n]+|<br>)*(<\/?(h[1-6r]|p|div|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|blockquote|center|dl|dt|dd|dir|fieldset)[^>]*>)(?:<br>&nbsp;[\s\r\n]+|<br>)*/g,"$1"]]),d([[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])),/class="?Mso|style="[^"]*\bmso-|w:WordDocument/i.test(j)||e.wordContent){e.wordContent=!0,d([/^\s*(&nbsp;)+/gi,/(&nbsp;|<br[^>]*>)+\s*$/gi]),b(k,"paste_convert_headers_to_strong")&&(j=j.replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>")),b(k,"paste_convert_middot_lists")&&d([[/<!--\[if !supportLists\]-->/gi,"$&__MCE_ITEM__"],[/(<span[^>]+(?:mso-list:|:\s*symbol)[^>]+>)/gi,"$1__MCE_ITEM__"],[/(<p[^>]+(?:MsoListParagraph)[^>]+>)/gi,"$1__MCE_ITEM__"]]),d([/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi," "]]);do l=j.length,j=j.replace(/(<[a-z][^>]*\s)(?:id|name|language|type|on\w+|\w+:\w+)=(?:"[^"]*"|\w+)\s?/gi,"$1");while(l!=j.length);0==b(k,"paste_retain_style_properties").replace(/^none$/i,"").length?j=j.replace(/<\/?span[^>]*>/gi,""):d([[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(o,h){return h.length>0?h.replace(/./," ").slice(Math.floor(h.length/2)).split("").join(" "):""}],[/(<[a-z][^>]*)\sstyle="([^"]*)"/gi,function(t,h,r){var u=[],o=0,q=n(f(r).replace(/&quot;/gi,"'"),";");return c(q,function(s){function x(A){return A+("0"!==A&&/\d$/.test(A))?"px":""}var w,y,z=n(s,":");if(2==z.length){switch(w=z[0].toLowerCase(),y=z[1].toLowerCase(),w){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-table-layout-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":return void(u[o++]=w.replace(/^mso-|-alt$/g,"")+":"+x(y));case"horiz-align":return void(u[o++]="text-align:"+y);case"vert-align":return void(u[o++]="vertical-align:"+y);case"font-color":case"mso-foreground":return void(u[o++]="color:"+y);case"mso-background":case"mso-highlight":return void(u[o++]="background:"+y);case"mso-default-height":return void(u[o++]="min-height:"+x(y));case"mso-default-width":return void(u[o++]="min-width:"+x(y));case"mso-padding-between-alt":return void(u[o++]="border-collapse:separate;border-spacing:"+x(y));case"text-line-through":return void("single"!=y&&"double"!=y||(u[o++]="text-decoration:line-through"));case"mso-zero-height":return void("yes"==y&&(u[o++]="display:none"))}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?!align|decor|indent|trans)|top-bar|version|vnd|word-break)/.test(w))return;u[o++]=w+":"+z[1]}}),o>0?h+' style="'+u.join(";")+'"':h}]])}b(k,"paste_convert_headers_to_strong")&&d([[/<h[1-6][^>]*>/gi,"<p><strong>"],[/<\/h[1-6][^>]*>/gi,"</strong></p>"]]),d([[/Version:[\d.]+\nStartHTML:\d+\nEndHTML:\d+\nStartFragment:\d+\nEndFragment:\d+/gi,""]]),i=b(k,"paste_strip_class_attributes"),"none"!==i&&(j=j.replace(/ class="([^"]+)"/gi,m),j=j.replace(/ class=([\-\w]+)/gi,m)),b(k,"paste_remove_spans")&&(j=j.replace(/<\/?span[^>]*>/gi,"")),e.content=j}},_postProcess:function(g,i){var d,f=this,e=f.editor,h=e.dom;0!=e.settings.paste_enable_default_filters&&(i.wordContent&&(c(h.select("a",i.node),function(j){j.href&&j.href.indexOf("#_Toc")==-1||h.remove(j,1)}),b(e,"paste_convert_middot_lists")&&f._convertLists(g,i),d=b(e,"paste_retain_style_properties"),tinymce.is(d,"string")&&"all"!==d&&"*"!==d&&(d=tinymce.explode(d.replace(/^none$/i,"")),c(h.select("*",i.node),function(m){var l,o,j,n={},k=0;if(d)for(l=0;l<d.length;l++)o=d[l],j=h.getStyle(m,o),j&&(n[o]=j,k++);h.setAttrib(m,"style",""),d&&k>0?h.setStyles(m,n):"SPAN"!=m.nodeName||m.className||h.remove(m,!0)}))),b(e,"paste_remove_styles")||b(e,"paste_remove_styles_if_webkit")&&tinymce.isWebKit?c(h.select("*[style]",i.node),function(j){j.removeAttribute("style"),j.removeAttribute("data-mce-style")}):tinymce.isWebKit&&c(h.select("*",i.node),function(j){j.removeAttribute("data-mce-style")}))},_convertLists:function(g,e){var h,l,f,k,j,i=g.editor.dom,d=-1,m=[];c(i.select("p",e.node),function(t){var q,s,r,n,o,u="";for(q=t.firstChild;q&&3==q.nodeType;q=q.nextSibling)u+=q.nodeValue;u=t.innerHTML.replace(/<\/?\w+[^>]*>/gi,"").replace(/&nbsp;/g," "),/^(__MCE_ITEM__)+[\u2022\u00b7\u00a7\u00d8o\u25CF]\s*\u00a0*/.test(u)&&(s="ul"),/^__MCE_ITEM__\s*\w+\.\s*\u00a0+/.test(u)&&(s="ol"),s?(f=parseFloat(t.style.marginLeft||0),f>d&&m.push(f),h&&s==k?f>d?h=l.appendChild(i.create(s)):f<d&&(n=tinymce.inArray(m,f),o=i.getParents(h.parentNode,s),h=o[o.length-1-n]||h):(h=i.create(s),i.insertAfter(h,t)),c(i.select("span",t),function(v){var p=v.innerHTML.replace(/<\/?\w+[^>]*>/gi,"");"ul"==s&&/^__MCE_ITEM__[\u2022\u00b7\u00a7\u00d8o\u25CF]/.test(p)?i.remove(v):/^__MCE_ITEM__[\s\S]*\w+\.(&nbsp;|\u00a0)*\s*/.test(p)&&i.remove(v)}),r=t.innerHTML,r="ul"==s?t.innerHTML.replace(/__MCE_ITEM__/g,"").replace(/^[\u2022\u00b7\u00a7\u00d8o\u25CF]\s*(&nbsp;|\u00a0)+\s*/,""):t.innerHTML.replace(/__MCE_ITEM__/g,"").replace(/^\s*\w+\.(&nbsp;|\u00a0)+\s*/,""),l=h.appendChild(i.create("li",0,r)),i.remove(t),d=f,k=s):h=d=0}),j=e.node.innerHTML,j.indexOf("__MCE_ITEM__")!=-1&&(e.node.innerHTML=j.replace(/__MCE_ITEM__/g,""))},_insert:function(f,d){var e=this.editor,g=e.selection.getRng();e.selection.isCollapsed()||g.startContainer==g.endContainer||e.getDoc().execCommand("Delete",!1,null),e.execCommand("mceInsertContent",!1,f,{skip_undo:d})},_insertPlainText:function(j){function e(m){c(m,function(n){j=n.constructor==RegExp?j.replace(n,""):j.replace(n[0],n[1])})}var h=this.editor,f=b(h,"paste_text_linebreaktype"),k=b(h,"paste_text_replacements"),g=tinymce.is;if("string"==typeof j&&j.length>0){e(/<(?:p|br|h[1-6]|ul|ol|dl|table|t[rdh]|div|blockquote|fieldset|pre|address|center)[^>]*>/i.test(j)?[/[\n\r]+/g]:[/\r+/g]),e([[/<\/(?:p|h[1-6]|ul|ol|dl|table|div|blockquote|fieldset|pre|address|center)>/gi,"\n\n"],[/<br[^>]*>|<\/tr>/gi,"\n"],[/<\/t[dh]>\s*<t[dh][^>]*>/gi,"\t"],/<[a-z!\/?][^>]*>/gi,[/&nbsp;/gi," "],[/(?:(?!\n)\s)*(\n+)(?:(?!\n)\s)*/gi,"$1"]]);var d=Number(b(h,"paste_max_consecutive_linebreaks"));if(d>-1){for(var l=new RegExp("\n{"+(d+1)+",}","g"),i="";i.length<d;)i+="\n";e([[l,i]])}j=h.dom.decode(tinymce.html.Entities.encodeRaw(j)),g(k,"array")?e(k):g(k,"string")&&e(new RegExp(k,"gi")),e("none"==f?[[/\n+/g," "]]:"br"==f?[[/\n/g,"<br />"]]:"p"==f?[[/\n+/g,"</p><p>"],[/^(.*<\/p>)(<p>)$/,"<p>$1"]]:[[/\n\n/g,"</p><p>"],[/^(.*<\/p>)(<p>)$/,"<p>$1"],[/\n/g,"<br />"]]),h.execCommand("mceInsertContent",!1,j)}},_legacySupport:function(){var e=this,d=e.editor;d.addCommand("mcePasteWord",function(){d.windowManager.open({file:e.url+"/pasteword.htm",width:parseInt(b(d,"paste_dialog_width")),height:parseInt(b(d,"paste_dialog_height")),inline:1})}),b(d,"paste_text_use_dialog")&&d.addCommand("mcePasteText",function(){d.windowManager.open({file:e.url+"/pastetext.htm",width:parseInt(b(d,"paste_dialog_width")),height:parseInt(b(d,"paste_dialog_height")),inline:1})}),d.addButton("pasteword",{title:"paste.paste_word_desc",cmd:"mcePasteWord"})}}),tinymce.PluginManager.add("paste",tinymce.plugins.PastePlugin)}();