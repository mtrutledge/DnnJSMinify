function CheckChanged(){var chk=$("#chkbillsame");chk.attr("checked")?$("#billingwrapper").hide():$("#billingwrapper").show()}function ClearTotals(){$("#totalsastable").html(" -- ")}function CleanCC(){var notclean=$("#cccardnumber").val();$.post("~/checkout/CleanCreditCard",{CardNumber:notclean},function(data){$("#cccardnumber").val(data.CardNumber)},"json")}function IsEmpty(input){return!(input.length>0)}function IsShippingValid(){return!0}function RefreshShipping(){$("#lstShipping").html(""),$(".shipping-changing").show(),$("#shipping-needs-refresh").hide(),$("#shipping-not-valid").hide(),$.ajax({type:"POST",url:"~/estimateshipping/getratesasradiobuttons",data:{country:$("#shippingcountry :selected").val(),firstname:$("#shippingfirstname").val(),lastname:$("#shippinglastname").val(),address:$("#shippingaddress").val(),city:$("#shippingcity").val(),zip:$("#shippingzip").val(),state:$("#shippingstate :selected").val(),orderid:$("#orderbvin").val()},dataType:"json",success:function(data){$(".shipping-changing").hide(),$("#lstShipping").html(data.rates),$("#lstShipping").show(),$("#totalsastable").html(data.totalsastable),BindShippingRadioButtons()},error:function(data){$(".shipping-changing").hide(),$("#shipping-not-valid").show(),ClearTotals()}})}function ShippingAddressChanged(){return $("#lstShipping").html(""),ClearTotals(),IsShippingValid()?(RefreshShipping(),$("#shipping-not-valid").hide()):$("#shipping-not-valid").show(),!0}function ApplyShippingMethod(methodid){ClearTotals(),$(".shipping-changing").show();var orderid=$("#orderbvin").val();$.ajax({type:"POST",url:"~/checkout/applyshipping",data:{MethodId:methodid,OrderId:orderid},dataType:"json",success:function(data){$(".shipping-changing").hide(),$("#totalsastable").html(data.totalsastable)},error:function(data){ClearTotals()}})}function ApplyCurrentShippingRate(){var rateKey=$("input[name='shippingrate']:checked").val();ApplyShippingMethod(rateKey)}function BindStateDropDownLists(){$("#shippingstate").change(function(){ShippingAddressChanged()})}function BindShippingRadioButtons(){$("input[name = 'shippingrate']").change(function(){ApplyCurrentShippingRate()})}function LoadRegionsWithSelection(regionlist,countryid,selectedregion){$.post("~/estimateshipping/getregions/"+countryid,{regionid:selectedregion},function(data){regionlist.html(data.Regions),$("#tempshippingregion").val(""),$("#tempbillingregion").val(""),BindStateDropDownLists()},"json")}$(document).ready(function(){BindStateDropDownLists(),$("#chkbillsame").click(function(){return CheckChanged(),!0}),$("#cccardnumber").change(function(){CleanCC()}),$("#billingcountry").change(function(){LoadRegionsWithSelection($("#billingstate"),$("#billingcountry option:selected").val(),$("#tempbillingregion").val())}),$("#shippingcountry").change(function(){LoadRegionsWithSelection($("#shippingstate"),$("#shippingcountry option:selected").val(),$("#tempshippingregion").val()),ShippingAddressChanged()}),LoadRegionsWithSelection($("#shippingstate"),$("#shippingcountry option:selected").val(),$("#tempshippingregion").val()),LoadRegionsWithSelection($("#billingstate"),$("#billingcountry option:selected").val(),$("#tempbillingregion").val()),$("#shippingregionname").change(function(){ShippingAddressChanged()}),$("#shippingfirstname").change(function(){ShippingAddressChanged()}),$("#shippinglastname").change(function(){ShippingAddressChanged()}),$("#shippingaddress").change(function(){ShippingAddressChanged()}),$("#shippingcity").change(function(){ShippingAddressChanged()}),$("#shippingzip").change(function(){ShippingAddressChanged()}),CheckChanged(),ShippingAddressChanged()});