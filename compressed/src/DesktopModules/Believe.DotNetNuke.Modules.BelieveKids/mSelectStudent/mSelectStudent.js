var Module_SelectStudent={firstNameID:"txtFirstName",lastNameID:"txtLastName",parentEmailID:"txtParentEmail",leaderNameID:"txtLeaderName",gradeID:"ddlGrade",continueRedirectUrl:"",IsFormValid:function(checkDuplicates){var isValid=!0,msg="You must enter the following:<ul>";if(0==$("#"+Module_SelectStudent.firstNameID).val().length&&(isValid=!1,msg+="<li>First Name</li>"),0==$("#"+Module_SelectStudent.lastNameID).val().length&&(isValid=!1,msg+="<li>Last Name</li>"),$("#"+Module_SelectStudent.parentEmailID).val().length>0){var reg=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;0==reg.test($("#"+Module_SelectStudent.parentEmailID).val())&&(isValid=!1,msg+="<li>Email must be in correct format: example@domain.com</li>")}if(isValid&&checkDuplicates){var existingStudent=Module_CookieHelper.getStudentFromCookieArray($("#"+Module_SelectStudent.firstNameID).val(),$("#"+Module_SelectStudent.lastNameID).val(),$("#"+Module_SelectStudent.parentEmailID).val());void 0!=existingStudent&&(isValid=!1,msg+="<li>You can not add the same student.</li>")}return msg+="</ul>",isValid||Module_SiteMessage.show_Error(msg,3e3),isValid},clearFields:function(){$("#"+Module_SelectStudent.firstNameID).val(""),$("#"+Module_SelectStudent.lastNameID).val(""),$("#"+Module_SelectStudent.parentEmailID).val(""),$("#"+Module_SelectStudent.leaderNameID).val(""),$("#"+Module_SelectStudent.gradeID).val("")},cancelEdit:function(){Module_SelectStudent.clearFields()},addStudentToCookie:function(){if(Module_SelectStudent.IsFormValid(!0)){var addedStudent=Module_CookieHelper.addCookieStudentArray($("#"+Module_SelectStudent.firstNameID).val(),$("#"+Module_SelectStudent.lastNameID).val(),$("#"+Module_SelectStudent.parentEmailID).val(),0,Module_CookieHelper.get(Module_CookieHelper.cookie_School_SelectedOPID),Module_CookieHelper.get(Module_CookieHelper.cookie_School_SelectedSCHOOL),0,Module_CookieHelper.get(Module_CookieHelper.cookie_School_SelectedSCHOOLIsTaxIncluded),Module_CookieHelper.get(Module_CookieHelper.cookie_School_SelectedSTATE),$("#"+Module_SelectStudent.leaderNameID).val(),$("#"+Module_SelectStudent.gradeID).val());return"Parent"==Module_CookieHelper.getCookie(Module_CookieHelper.cookie_BelieveUserProfileType)&&this._PostStudent(addedStudent),Module_SelectStudent.splitCreditsEven(),Module_SelectStudent.getHtmlGrid(),Module_SelectStudent.clearFields(),!0}return!1},updateStudentToCookie:function(){if(Module_SelectStudent.IsFormValid(!1)){var divID=$("#btnUpdateSeller").data("editing"),student=Module_CookieHelper.getStudentFromCookieArray($("#"+divID+" .sellerFirstName").text(),$("#"+divID+" .sellerLastName").text(),$("#"+divID+" .sellerParentEmail").text());return student.FirstName=$("#"+Module_SelectStudent.firstNameID).val(),student.LastName=$("#"+Module_SelectStudent.lastNameID).val(),student.ParentsEmailAddress=$("#"+Module_SelectStudent.parentEmailID).val(),student.LeaderName=$("#"+Module_SelectStudent.leaderNameID).val(),student.Grade=$("#"+Module_SelectStudent.gradeID).val(),Module_CookieHelper.setCookie(Module_CookieHelper.cookie_School_SelectedSellerArray,Module_CookieHelper.students),Module_SelectStudent.getHtmlGrid(),$("#btnCancelEdit").hide(),$("#btnUpdateSeller").hide(),$("#btnAddSeller").show(),$("#btnSellerContinue").show(),Module_SelectStudent.clearFields(),!0}return!1},_PostStudent:function(student){student.ParentsDnnUserID=cuid,$.ajax({type:"POST",url:"/DesktopModules/Believe.DotNetNuke.Modules.BelieveKids/API/Student/AddStudent",data:student,dataType:"json",success:function(data){var updatedStudent=JSON.parse(data),existingStudent=Module_CookieHelper.getStudentFromCookieArray(student.FirstName,student.LastName,student.ParentsEmailAddress);existingStudent.StudentID=updatedStudent.StudentID,existingStudent.ParentsDnnUserID=updatedStudent.ParentsDnnUserID,Module_CookieHelper.setCookie(Module_CookieHelper.cookie_School_SelectedSellerArray,Module_CookieHelper.students)}})},addCreditToStudent:function(fname,lname,pemail){0!=Module_SelectStudent.getUnAllocatedCreditCount()&&(Module_CookieHelper.updateStudentPoints(fname,lname,pemail,1),$("#sellerGridAvailPoints .credits").text(Math.abs(Module_SelectStudent.getUnAllocatedCreditCount())),Module_SelectStudent.getHtmlGrid())},removeCreditFromStudent:function(fname,lname,pemail,mainID){0!=$("#"+mainID+" .sgCredits #sellerCredits").text()&&(Module_CookieHelper.updateStudentPoints(fname,lname,pemail,-1),$("#sellerGridAvailPoints .credits").text(Math.abs(Module_SelectStudent.getUnAllocatedCreditCount())),Module_SelectStudent.getHtmlGrid())},getTotalStudentCredits:function(){var points=0;return $.each(Module_CookieHelper.getCookieStudentArray(),function(index,value){var stud=value;isNaN(parseInt(stud.TotalPrizeCredits))||(points+=parseInt(stud.TotalPrizeCredits))}),points},getUnAllocatedCreditCount:function(){var result=parseInt(Module_SelectStudent.getTotalStudentCredits())-parseInt(Module_CookieHelper.get(Module_CookieHelper.cookie_Items_InCart));return isNaN(result)?0:result},canAddStudentCredits:function(){return Module_SelectStudent.getUnAllocatedCreditCount()>Module_SelectStudent.getTotalStudentCredits()},initStudentCreditsToZero:function(){var studentArray=Module_CookieHelper.getCookieStudentArray();$.each(studentArray,function(index,obj){obj.TotalPrizeCredits=0}),Module_CookieHelper.setCookie(Module_CookieHelper.cookie_School_SelectedSellerArray,studentArray)},splitCreditsEven:function(isReload){var splitEven=!0;if(0==Module_SelectStudent.getUnAllocatedCreditCount()&&(splitEven=!1),Module_SelectStudent.getTotalStudentCredits()!=Module_CookieHelper.get(Module_CookieHelper.cookie_Items_InCart)&&(splitEven=!0),1==splitEven&&(this.initStudentCreditsToZero(),1==$.isNumeric(Module_CookieHelper.get(Module_CookieHelper.cookie_Items_InCart))&&Module_CookieHelper.get(Module_CookieHelper.cookie_Items_InCart)>=1)){var studentArray=Module_CookieHelper.getCookieStudentArray();if(studentArray.length>0)for(var studentAmount=studentArray.length,cartAmount=parseInt(Module_CookieHelper.get(Module_CookieHelper.cookie_Items_InCart)),studentIndex=0,i=0;i<cartAmount;i++){studentIndex>=studentAmount&&(studentIndex=0);var items=studentArray[studentIndex],fname=items.FirstName,lname=items.LastName,pemail=items.ParentsEmailAddress;Module_CookieHelper.updateStudentPoints(fname,lname,pemail,1),studentIndex++}}},editStudent:function(divID){var student=Module_CookieHelper.getStudentFromCookieArray($("#"+divID+" .sellerFirstName").text(),$("#"+divID+" .sellerLastName").text(),$("#"+divID+" .sellerParentEmail").text());$("#"+Module_SelectStudent.firstNameID).val(student.FirstName),$("#"+Module_SelectStudent.lastNameID).val(student.LastName),$("#"+Module_SelectStudent.parentEmailID).val(student.ParentsEmailAddress),$("#"+Module_SelectStudent.leaderNameID).val(student.LeaderName),$("#"+Module_SelectStudent.gradeID).val(student.Grade),$("#btnUpdateSeller").data("editing",divID),$("#btnCancelEdit").show(),$("#btnUpdateSeller").show(),$("#btnAddSeller").hide(),$("#btnSellerContinue").hide()},removeStudent:function(divID){Module_CookieHelper.removeStudentFromCookieArray($("#"+divID+" .sellerFirstName").text(),$("#"+divID+" .sellerLastName").text(),$("#"+divID+" .sellerParentEmail").text()),Module_SelectStudent.splitCreditsEven(),Module_SelectStudent.getHtmlGrid(),"Parent"==Module_CookieHelper.getCookie(Module_CookieHelper.cookie_BelieveUserProfileType)&&this._PostRemoveStudent(student.studentID)},_PostRemoveStudent:function(studentID){$.ajax({type:"POST",url:"/DesktopModules/Believe.DotNetNuke.Modules.BelieveKids/API/Student/RemoveStudent?studentID="+studentID})},showNextButton:function(){return""!=Module_SelectStudent.continueRedirectUrl},nextButtonClick:function(){Module_SelectStudent.checkAndEnableNextButtonIfValid()},checkAndEnableNextButtonIfValid:function(){return!(($("#"+Module_SelectStudent.firstNameID).val().length>0||$("#"+Module_SelectStudent.lastNameID).val().length>0)&&!Module_SelectStudent.addStudentToCookie())&&void(null!=Module_CookieHelper.get(Module_CookieHelper.cookie_School_SelectedSellerArray)&&Module_CookieHelper.get(Module_CookieHelper.cookie_School_SelectedSellerArray).length>=1?"Parent"==Module_CookieHelper.get(Module_CookieHelper.cookie_BelieveUserProfileType)?(Module_AjaxHelper.set_AddStudents(),window.location.href="/Dashboard"):null!=Module_CookieHelper.get(Module_CookieHelper.cookie_Items_InCart)&&Module_CookieHelper.get(Module_CookieHelper.cookie_Items_InCart)>=1?window.location.href="/Cart":window.location.href=Module_SelectStudent.continueRedirectUrl:Module_SiteMessage.show_Error("You must add a seller",3e3))},emailsocialCheckAndEnableNextButtonIfValid:function(){return!(($("#"+Module_SelectStudent.firstNameID).val().length>0||$("#"+Module_SelectStudent.lastNameID).val().length>0)&&!Module_SelectStudent.addStudentToCookie())&&(null==Module_CookieHelper.get(Module_CookieHelper.cookie_School_SelectedSellerArray)&&0==Module_CookieHelper.get(Module_CookieHelper.cookie_School_SelectedSellerArray).length?(Module_SiteMessage.show_Error("You must add a seller",3e3),!1):void 0)},buildHtmlGrid:function(mainID,firstName,lastName,parentEmail,sellerCredits){var html="";return html=html+"<div id='"+mainID+"'>",html+="<div class='row sgRow'>",editEnabled?(html=html+"<div class='sgName col-xs-8 col-sm-8'><span class='sellerFirstName'>"+firstName+"</span>&nbsp;<span class='sellerLastName'>"+lastName+"</span></div>",html=html+"<div class='sgEdit col-xs-2 col-sm-2' onclick=\"Module_SelectStudent.editStudent('"+mainID+"');\"><span style='font-size: 20px; cursor: pointer;'><i class='fa fa-pencil'></i></span></div>",html+="<div class='sgRemove col-xs-2 col-sm-2'><span id='sellerRemoveButton' class='sgRemoveFirst' style='cursor: pointer;'><i class='fa fa-trash-o'></i></span></div>"):(html=html+"<div class='sgName col-xs-9 col-sm-10'><span class='sellerFirstName'>"+firstName+"</span>&nbsp;<span class='sellerLastName'>"+lastName+"</span></div>",html+="<div class='sgRemove col-xs-3 col-sm-2'><span id='sellerRemoveButton' class='sgRemoveFirst' ><i class='fa fa-trash-o'></i></span></div>"),void 0!=parentEmail&&""!=parentEmail&&(html=html+"<div class='sgEmail col-xs-12'><span class='sellerParentEmail'>"+parentEmail+"</span></div>"),void 0!=sellerCredits&&($.isNumeric(sellerCredits)?html=html+"<div class='sgCredits col-sm-12'><span id='sellerCredits'><i id='creditsDown' class='fa fa-minus' onclick=\"Module_SelectStudent.removeCreditFromStudent('"+firstName.replace("'","\\'")+"','"+lastName.replace("'","\\'")+"','"+parentEmail+"','"+mainID+"');\"></i>&nbsp;&nbsp;"+sellerCredits+"&nbsp;&nbsp;<i id='creditsUp' class='fa fa-plus' onclick=\"Module_SelectStudent.addCreditToStudent('"+firstName.replace("'","\\'")+"','"+lastName.replace("'","\\'")+"','"+parentEmail+"');\" ></i></span><h5>Prize Credits</h5></div>":(sellerCredits=0,html=html+"<div class='sgCredits col-sm-12'><span id='sellerCredits'><i id='creditsDown' class='fa fa-minus' onclick=\"Module_SelectStudent.removeCreditFromStudent('"+firstName.replace("'","\\'")+"','"+lastName.replace("'","\\'")+"','"+parentEmail+"','"+mainID+"');\"></i>&nbsp;&nbsp;"+sellerCredits+"&nbsp;&nbsp;<i id='creditsUp' class='fa fa-plus' onclick=\"Module_SelectStudent.addCreditToStudent('"+firstName.replace("'","\\'")+"','"+lastName.replace("'","\\'")+"','"+parentEmail+"');\" ></i></span><h5>Prize Credits</h5></div>")),html=html+"<div class='sgRemoveCover' onclick=\"Module_SelectStudent.removeStudent('"+mainID+"');\"><span><h3><i class='fa fa-trash-o'></i>&nbsp;Remove</h3></span></div>",html+="</div></div>"},getHtmlGrid:function(){html="",cnt=0,$.each(Module_CookieHelper.getCookieStudentArray(),function(index,value){firstName=value.FirstName,lastName=value.LastName,parentEmail=value.ParentsEmailAddress,sellerCredits=value.TotalPrizeCredits;var mainID="sellerInformation_"+cnt;html+=Module_SelectStudent.buildHtmlGrid(mainID,firstName,lastName,parentEmail,sellerCredits),cnt++}),$("#sellerGrid").html(html),$("#sellerGridAvailPoints .credits").text(Math.abs(Module_SelectStudent.getUnAllocatedCreditCount()))}};