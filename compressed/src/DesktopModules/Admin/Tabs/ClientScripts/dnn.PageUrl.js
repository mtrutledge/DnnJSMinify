"undefined"!=typeof dnn&&null!==dnn||(dnn={}),function($,window,document,undefined){"use strict";var PageUrl=this.PageUrl=function(options){this.options=options,this.init()};PageUrl.prototype={constructor:PageUrl,init:function(){this.options=$.extend({},PageUrl.defaults(),this.options),this.$this=$(this),this._serviceUrl=$.dnnSF().getServiceRoot("InternalServices"),this._$pageUrlContainer=$("#"+this.options.pageUrlContainerId),this._$pageUrlInputInput=$("#"+this.options.pageUrlInputId),this._$pageUrlInputInput.prefixInput({prefix:"/"})},makeUpdatable:function(){var $button=$("<a href='javascript:void(0);' class='dnnSecondaryAction' />").text($.htmlEncode(this.options.updateUrlButtonCaption)).prop("title",this.options.updateUrlButtonTooltip),savePageUrlHandler=$.proxy(this._savePageUrl,this);$button.on("click",savePageUrlHandler),this._$pageUrlInputInput.onEnter(savePageUrlHandler),this._$pageUrlContainer.append($button),this._$pageUrlContainer.removeClass().addClass("um-page-url-container-updatable")},_savePageUrl:function(){var path=this._$pageUrlInputInput.val(),postData=this.options.updateUrlDto;postData.Path=path,this._updateCustomUrlServiceSettings||(this._updateCustomUrlServiceSettings={beforeSend:$.dnnSF().setModuleHeaders,url:this._serviceUrl+"PageService/UpdateCustomUrl",type:"POST",async:!0,success:$.proxy(this._onUpdateUrl,this),error:$.onAjaxError});var serviceSettings=this._updateCustomUrlServiceSettings;serviceSettings.data=postData,$.ajax(serviceSettings)},_onUpdateUrl:function(data,textStatus,jqXhr){data.Success?(this.$this.trigger("onUpdateUrl"),this._$pageUrlInputInput.quickHighlight()):($.dnnAlert({title:this.options.errorTitle||"Error",text:data.ErrorMessage||"Unknown error"}),data.SuggestedUrlPath&&this._$pageUrlInputInput.val(data.SuggestedUrlPath))}},PageUrl._defaults={},PageUrl.defaults=function(settings){return"undefined"!=typeof settings&&$.extend(PageUrl._defaults,settings),PageUrl._defaults}}.apply(dnn,[jQuery,window,document]),dnn.createPageUrl=function(options){$(document).ready(function(){var instance=new dnn.PageUrl(options);dnn.PageUrlSynchronizer.getInstance().setPageUrl(instance)})},function($,window,document,undefined){"use strict";function PageUrlSynchronizerInternal(){this.init()}this.PageUrlSynchronizer=dnn.singletonify(PageUrlSynchronizerInternal);PageUrlSynchronizerInternal.prototype={constructor:PageUrlSynchronizerInternal,init:function(){this._$urlManagementInstance=null,this._$pageUrlInstance=null},setPageUrl:function(instance){instance&&(this._$pageUrlInstance=$(instance),this._$pageUrlInstance.on("onUpdateUrl",$.proxy(this._onUpdateUrl,this)),instance.makeUpdatable())},_onUpdateUrl:function(){this._urlManagementInstance&&this._urlManagementInstance.refreshView()},setUrlManagement:function(instance){instance&&(this._urlManagementInstance=instance)}}}.apply(dnn,[jQuery,window,document]);