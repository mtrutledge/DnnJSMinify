function ExcludedFileExtensionsViewModel(){var self=this;self.editing=ko.observable(!1),self.newExtensionName=ko.observable(""),self.title="Excluded File Extensions View Model",self.fileExtensions=ko.observableArray([]),self.settings="",self.getDnnService=function(moduleId){return"undefined"!=typeof $.dnnSF?$.dnnSF(moduleId):null},self.getSearchServiceUrl=function(service){return service=service||self.getDnnService(),service?service.getServiceRoot("SearchCrawler")+"SearchAdminExcludedExtensions/":null},self.addExtension=function(){self.editing(!0);var newExt=new FileExtension("","",!1);newExt.newExtension(!0),self.fileExtensions.unshift(newExt),newExt.isSelected(!0),self.focusNewExtension()},self.removeExtension=function(fileExtension){var searchService=self.getDnnService(self.settings.moduleId),searchServiceUrl=self.getSearchServiceUrl(searchService);if(fileExtension.newExtension())self.fileExtensions.remove(fileExtension);else{var jsonData=ko.toJSON(fileExtension);$.ajax({url:searchServiceUrl,type:"DELETE",data:jsonData,beforeSend:searchService.setModuleHeaders,contentType:"application/json; charset=utf-8",success:function(xhr){self.fileExtensions.remove(fileExtension)}})}},self.saveExtension=function(fileExtension){var searchService=self.getDnnService(self.settings.moduleId),searchServiceUrl=self.getSearchServiceUrl(searchService);fileExtension.isSelected(!1);var jsonData=ko.toJSON(fileExtension);$.ajax({url:searchServiceUrl,type:"POST",data:jsonData,beforeSend:searchService.setModuleHeaders,contentType:"application/json; charset=utf-8",success:function(normalizedExtension){fileExtension.newExtension(!1),fileExtension.extension(normalizedExtension)},error:function(xhr){switch(xhr.responseText){case'"NotInWhitelist"':fileExtension.errorHtml=self.settings.msgFileExtensionNotAllowed,fileExtension.showError(!0),self.focusNewExtension();break;case'"Duplicate"':fileExtension.errorHtml=self.settings.msgFileExtensionDuplicated,fileExtension.showError(!0),self.focusNewExtension()}}})},self.loadExtensions=function(){var searchService=self.getDnnService(self.settings.moduleId),searchServiceUrl=self.getSearchServiceUrl(searchService);$.ajax({url:searchServiceUrl,type:"GET",beforeSend:searchService.setModuleHeaders,contentType:"application/json; charset=utf-8",success:function(data){data.forEach(function(serverExtension){var ext=new FileExtension(serverExtension.Extension,"",!1);ext.newExtension(!1),ext.isSelected(!1),self.fileExtensions.push(ext)})}})},self.addOnEnter=function(data,event){data.showError(!1);var keyCode=event.which?event.which:event.keyCode;return 13!==keyCode||(self.saveExtension(data),!1)},self.focusNewExtension=function(){$("#newExtension").focus()}}