window.dnn=window.dnn||{},window.dnn.utils=window.dnn.utils||{},function(){var KoBindedDialogClass;KoBindedDialogClass=function($,ko){"use strict";function KoBindedDialog(options,htmlForPannels,koObserveCallback,afterBindCallback){return KoBindedDialog.active?void console.log("KoBindedDialog already opened"):(KoBindedDialog.active=!0,_expanded=!1,options||(options={enterprise:!0,inObject:null,animation:!0,width:650,title:"Notice",innerTitle:"",showAcceptBtn:!0,acceptBtnLbl:"Accept",showCancelBtn:!0,cancelBtnLbl:"Cancel",onAcceptCallback:null,beforeCloseCallback:null,onCloseCallback:null,closeOnAccept:!0}),options.enterprise=!0,_options=options,options.enterprise!==!1&&(_options.enterprise=!0),options.width||(_options.width=650),options.title||(_options.title="Notice"),options.inObject||(_options.inObject=$(document.body)),options.animation!==!1&&(_options.animation=!0),options.innerTitle||(_options.innerTitle=""),options.acceptBtnLbl||(_options.acceptBtnLbl="Accept"),options.showAcceptBtn!==!1&&(_options.showAcceptBtn=!0),options.cancelBtnLbl||(_options.cancelBtnLbl="Cancel"),options.showCancelBtn!==!1&&(_options.showCancelBtn=!0),options.animation!==!1&&(_options.animation=!0),options.closeOnAccept!==!1&&(_options.closeOnAccept=!0),_viewModel={},htmlForPannels||(htmlForPannels=""),_htmlForPannels=htmlForPannels,_msieOrFf=navigator.userAgent.search(/msie|\.net|firefox/i)!==-1,addDialog(),void setTimeout(function(){initDialog();var personaBarDialog=$(".personaBarDialog");personaBarDialog.width(_options.width),htmlForPannels&&personaBarDialog.find(".panels").prepend(htmlForPannels),setTimeout(function(){applyBindings("function"==typeof koObserveCallback?koObserveCallback():void 0),setTimeout(function(){"function"==typeof afterBindCallback&&afterBindCallback()},0),showDialog()},0)},0))}var HEIGHT_DIALOG,_options,_html,_viewModel,_htmlForPannels,_personaBarDialogMask,_personaBarDialog,_originalHeight,_win,_expanded,_initialBounds,_msieOrFf,addDialog,applyBindings,closeDialog,acceptDialog,initDialog,showDialog,updateHeight,toggleExpand;return KoBindedDialog.class="KoBindedDialog",KoBindedDialog.type="Class",KoBindedDialog.active=!1,HEIGHT_DIALOG=651,_html='<div class="personaBarDialogMask" style="display:none;"></div>                <div class="personaBarDialog" style="display:none;">                    <div class="container">                        <div class="title">                            <div class="dialogTitle" data-bind="html: title"></div>                            <hr class="bottomTitleHR">                            <span class="btn-close" data-bind="visible: !enterprise, click: closeDialog"></span>                            <div class="dnnModalCtrl" data-bind="visible: enterprise">                                <a href="#" data-bind="click: toggleExpand" class="dnnToggleMax"><span>Max</span></a>                                <button data-bind="click: closeDialog" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only ui-dialog-titlebar-close" role="button" aria-disabled="false" title="close"><span class="ui-button-icon-primary ui-icon ui-icon-closethick"></span><span class="ui-button-text">close</span></button>                            </div>                        </div>                        <div class="superContent">                            <div class="content">                                <div class="title" data-bind="html: innerTitle"></div>                                <div class="panels" data-bind="with: dialogHTML"></div>                                <div class="actions">                                    <span class="btn btn-accept dnnPrimaryAction" data-bind="visible: showAcceptBtn, text: acceptBtnLbl, click: acceptDialog"></span>                                    <span class="btn btn-cancel dnnSecondaryAction" data-bind="visible: showCancelBtn, text: cancelBtnLbl, click: closeDialog"></span>                                </div>                            </div>                            <div class="resizeCorner" data-bind="visible: enterprise"><div class="resizeHandler"></div></div>                        </div>                    </div>                </div>',_options=null,_viewModel=null,_personaBarDialog=null,_personaBarDialogMask=null,applyBindings=function(viewModel){setTimeout(function(){_viewModel={dialogHTML:"",enterprise:ko.observable(_options.enterprise),title:ko.observable(_options.title),innerTitle:ko.observable(_options.innerTitle),acceptBtnLbl:ko.observable(_options.acceptBtnLbl),showAcceptBtn:ko.observable(_options.showAcceptBtn),cancelBtnLbl:ko.observable(_options.cancelBtnLbl),showCancelBtn:ko.observable(_options.showCancelBtn),acceptDialog:acceptDialog,closeDialog:closeDialog,enableAccept:ko.observable(!0),toggleExpand:toggleExpand},"object"==typeof viewModel&&(_viewModel.dialogHTML=viewModel,viewModel.enableAcceptForDialog&&(_viewModel.enableAccept=viewModel.enableAcceptForDialog)),ko.applyBindings(_viewModel,_personaBarDialog[0])},0)},addDialog=function(){return $("body").prepend(_html)},closeDialog=function(){var node;$("body").css("overflow","auto"),_win&&_win.off(".personaBarDialog"),$(document).off(".personaBarDialog"),_personaBarDialog&&_personaBarDialog.off("DOMMouseScroll mousewheel"),node=$(".personaBarDialog"),"function"==typeof _options.beforeCloseCallback&&_options.beforeCloseCallback(),node.length>0&&ko.cleanNode($(".personaBarDialog")[0]),_options.inObject.height(_originalHeight),_personaBarDialog.remove(),_personaBarDialogMask.remove(),"function"==typeof _options.onCloseCallback&&_options.onCloseCallback(),window.dnn.utils.KoBindedDialog.active=!1},acceptDialog=function(){("boolean"!=typeof _viewModel.enableAccept||_viewModel.enableAccept)&&("function"!=typeof _viewModel.enableAccept||_viewModel.enableAccept())&&("function"==typeof _options.onAcceptCallback&&_options.onAcceptCallback(),_options.closeOnAccept===!0&&closeDialog())},initDialog=function(){var doc,resizableHandler,mouseMoveHandler,mouseUpHandler,title,superContent,content,dnnModalCtrl,mouseInitDelta;if(_win=$(window),doc=$(document),_personaBarDialogMask=$(".personaBarDialogMask"),_personaBarDialog=$(".personaBarDialog"),_personaBarDialogMask.css({height:doc.height()+_personaBarDialog.height()}),_options.enterprise)return $("body").css("overflow","hidden"),_personaBarDialog.find(".title:first").css("cursor","move"),_personaBarDialog.find(".content").css({"overflow-y":"scroll",height:"550px"}),_personaBarDialog.css({width:_options.width}),_personaBarDialog.position({my:"center",at:"center",of:window}),_personaBarDialog.draggable({handle:".dialogTitle",cursor:"move",start:function(){$(this).data("startingScrollTop",$(this).parent().parent().scrollTop())},drag:function(event,ui){var st=parseInt($(this).data("startingScrollTop"));ui.position.top-=st}}),_personaBarDialog.height(HEIGHT_DIALOG),_win.off("keydown.personaBarDialog").on("keydown.personaBarDialog",function(evt){27===evt.keyCode&&closeDialog()}),resizableHandler=_personaBarDialog.find(".resizeHandler:last"),title=_personaBarDialog.find(".title:first"),superContent=_personaBarDialog.find(".superContent:first"),content=_personaBarDialog.find(".content:first"),dnnModalCtrl=_personaBarDialog.find(".dnnModalCtrl:first"),0!==title.width()&&dnnModalCtrl.css("left",title.width()-55),mouseInitDelta={initial:{x:0,y:0},final:{x:0,y:0}},mouseMoveHandler=function(evt){var delta,right;evt.preventDefault(),delta={x:evt.pageX-mouseInitDelta.x,y:evt.pageY-mouseInitDelta.y},mouseInitDelta={x:evt.pageX,y:evt.pageY},title.width(title.width()+delta.x),superContent.width(superContent.width()+delta.x),dnnModalCtrl.css("left",title.width()-55),dnnModalCtrl.css("right",right),superContent.height()+delta.y<_initialBounds.superContent.height||(superContent.height(superContent.height()+delta.y),content.height(content.height()+delta.y))},mouseUpHandler=function(){doc.off("mousemove.personaBarDialog",mouseMoveHandler),doc.off("mouseup.personaBarDialog",mouseUpHandler)},void resizableHandler.off("mousedown.personaBarDialog").on("mousedown.personaBarDialog",function(evt){evt.preventDefault(),_initialBounds||(_initialBounds={left:_personaBarDialog.offset().left,title:{width:title.width()},superContent:{height:superContent.height(),width:superContent.width()},content:{height:content.height(),width:content.width()},dnnModalCtrl:{right:parseInt(dnnModalCtrl.css("right"),10)}},title.css({"max-height":title.height(),"min-height":title.height(),"min-width":title.width()}),superContent.css({"min-height":superContent.height(),"min-width":superContent.width()}),content.css({"min-height":content.height(),"min-width":content.width()})),mouseInitDelta={x:evt.pageX,y:evt.pageY},doc.on("mousemove.personaBarDialog",mouseMoveHandler),doc.on("mouseup.personaBarDialog",mouseUpHandler)})},showDialog=function(){_personaBarDialogMask.show(),_options.animation?_personaBarDialog.fadeIn(100):_personaBarDialog.show()},updateHeight=function(){_personaBarDialogMask.css({"min-height":$(document).scrollTop()+_personaBarDialog.height()+400+"px"})},toggleExpand=function(){var title,superContent,content,dnnModalCtrl;if(title=_personaBarDialog.find(".title:first"),superContent=_personaBarDialog.find(".superContent:first"),content=_personaBarDialog.find(".content:first"),dnnModalCtrl=_personaBarDialog.find(".dnnModalCtrl:first"),_initialBounds||(_initialBounds={left:_personaBarDialog.offset().left,title:{width:title.width()},superContent:{height:superContent.height(),width:superContent.width()},content:{height:content.height(),width:content.width()},dnnModalCtrl:{right:parseInt(dnnModalCtrl.css("right"),10)}},title.css({"max-height":title.height(),"min-height":title.height(),"min-width":title.width()}),superContent.css({"min-height":superContent.height(),"min-width":superContent.width()}),content.css({"min-height":content.height(),"min-width":content.width()})),superContent.css({height:_initialBounds.superContent.height}),_expanded)$("body").css("overflow","scroll"),superContent.css({width:_initialBounds.superContent.width,height:_initialBounds.superContent.height}),title.css({width:_initialBounds.title.width}),initDialog(),_expanded=!1;else{var margin;margin=50,_win.off(".personaBarDialog"),_personaBarDialog.off("DOMMouseScroll mousewheel"),$("body").css("overflow","hidden"),_personaBarDialog.css({width:"calc(100% - 4px)",top:margin/2+$(document).scrollTop()+"px","margin-left":"2px",left:0}),setTimeout(function(){title.width("calc(100% - 4px)"),superContent.css({height:$(window).height()-2*margin-title.height(),width:"calc(100% - 34px)"}),content.css({height:superContent.height()-100,width:"100%"}),dnnModalCtrl.css("left",title.width()-55)},0),_expanded=!0}},KoBindedDialog.prototype.updateHeight=updateHeight,KoBindedDialog.prototype.close=closeDialog,KoBindedDialog}(jQuery,ko),window.dnn.utils.KoBindedDialog=KoBindedDialogClass}.call(this);