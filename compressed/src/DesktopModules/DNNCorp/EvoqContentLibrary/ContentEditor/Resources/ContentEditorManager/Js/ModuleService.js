"undefined"!=typeof dnn&&null!==dnn||(dnn={}),"undefined"!=typeof dnn.ContentEditorManager&&null!==dnn.ContentEditorManager||(dnn.ContentEditorManager={}),function($){var dnnModuleService=dnn.dnnModuleService=function(options){this.options=options,this.init()};dnnModuleService.prototype={init:function(){this.options=$.extend({},dnnModuleService.defaultOptions,this.options),this._service=$.dnnSF(this.options.moduleId)},isLoading:function(){return this._loading},request:function(method,type,params,successCallback,errorCallback){$.ajax({url:this._getServiceUrl()+method,type:type,data:params,async:this.options.async,beforeSend:$.proxy(this._beforeSend,this),complete:$.proxy(this._completeRequest,this),success:function(data){"function"==typeof successCallback&&successCallback(data)},error:function(xhr){if(xhr&&"401"==xhr.status){var loginUrl=dnn.getVar("cem_loginurl");return void("undefined"!=typeof window.dnnModal?window.dnnModal.show(loginUrl+(loginUrl.indexOf("?")==-1?"?":"&")+"popUp=true",!0,300,650,!0,""):location.href=loginUrl)}return"function"==typeof errorCallback?void errorCallback(xhr):void $.dnnAlert({title:"Error",text:"Error occurred when request service '"+method+"'."})}})},getTabId:function(){return this._service.getTabId()},_beforeSend:function(xhr){this._service.setModuleHeaders(xhr),this._loading=!0},_completeRequest:function(xhr,status){this._loading=!1},_getServiceUrl:function(){return this._service.getServiceRoot(this.options.service)+this.options.controller+"/"}},dnnModuleService.defaultOptions={async:!0}}(jQuery);