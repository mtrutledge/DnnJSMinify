if(!RedactorPlugins)var RedactorPlugins={};var isCustomImage=!1,imageUploaded=0;RedactorPlugins.dnnImageUpload={FAKE_PROGRESS_TIME:5e3,init:function(){this.buttonAdd("dnnImageUpload","Insert image",this.dnnImageShow),this.buttonAwesome("dnnImageUpload","fa-bullhorn")},dnnImageEditText:function(){var dnnInsertImage;return this.opts.curLang.exceedLimit=this.opts.curLang.exceedLimit.replace("{0}",this.opts.maxFileSize/1048576),dnnInsertImage='<section id="redactor-modal-image-insert"><div id="redactor_tabs"><a href="#" id="redactor-tab-control-1" class="redactor_tabs_act leftside">'+this.opts.curLang.uploadFile+'</a><a href="#" id="redactor-tab-control-2">'+this.opts.curLang.storedLocation+'</a><a href="#" id="redactor-tab-control-3" class="rightside">'+this.opts.curLang.fromUrl+'</a></div><form id="redactorInsertImageForm" method="post" action="" enctype="multipart/form-data"><div id="redactor_tab1" class="redactor_tab"><input type="file" id="redactor_file" name="'+this.opts.imageUploadParam+'" /></div><div id="redactor_tab2" class="redactor_tab" style="display: none;"><div class="redactor_content" style="display:none;"><div class="redactor_search"><input type="text" name="redactor_search_file" id="redactor_search_file" class="redactor_input" placeholder="Search"></div></div><div id="redactor_image_box"></div></div></form><div id="redactor_tab3" class="redactor_tab redactor_tab_url" style="display: none;"><div class="link_form"><label>'+this.opts.curLang.enterResourceUrl+'</label><input type="text" name="redactor_file_link" id="redactor_file_link" class="redactor_input"  /></div><div class="preview-main"><div class="preview-img"><img /></div><div class="preview-name"></div></div></div><div id="redactor-modal-image-upload-status"><div class="upload-status-container"><div class="upload-status-caption">'+this.opts.curLang.uploadStatusTitle+'</div><div class="upload-status-main"><div class="upload-status-preview"><img /></div><div class="upload-status-name"></div><div class="upload-status-progress"><div class="bar"><span /></div><span class="btn-cancel" /></div><div class="upload-status-message"></div></div></div></div></section><footer><button class="redactor_modal_btn redactor_modal_action_btn redactor_upload_btn_1 redactor-img-btn" id="redactor_upload_btn1" disabled="disabled">'+this.opts.curLang.insertImage+'</button><button class="redactor_modal_btn redactor_modal_action_btn redactor_upload_btn_2 redactor-img-btn" id="redactor_upload_btn2" disabled="disabled">'+this.opts.curLang.insertImage+'</button><button class="redactor_modal_btn redactor_modal_action_btn redactor_upload_btn_3 redactor-img-btn" id="redactor_upload_btn" disabled="disabled">'+this.opts.curLang.insertImage+'</button><button class="redactor_modal_btn redactor_btn_modal_close">'+this.opts.curLang.cancel+"</button></footer>"},dnnImageShow:function(){this.selectionSave();var callback=$.proxy(function(){var context=this;if(this.opts.imageGetJson){"undefined"!=typeof redactorDropDownOptions&&(redactorDropDownOptions.onSelectionChangedBackScript=function(){var folderId=context._folderPicker.selectedItem().key;context.dnnLoadImages($("#redactor_search_file").val(),folderId)},redactorDropDownOptions.itemList.containerCss="dt-container redactor_box",this._folderPicker=new dnn.DropDownList(null,redactorDropDownOptions),$("#redactor_image_box").before(this._folderPicker.$element),this._folderPicker.$element.wrapAll('<div id="dnnRedactor_select" />'));var searchKeyChangedHandler;$("#redactor_search_file").keyup(function(){searchKeyChangedHandler&&clearTimeout(searchKeyChangedHandler),searchKeyChangedHandler=setTimeout(function(){var folderId=-1;"undefined"!=typeof context._folderPicker&&(folderId=context._folderPicker.selectedItem().key),context.dnnLoadImages($("#redactor_search_file").val(),folderId)},500)}),$(".redactor_upload_btn_2").on("click",function(){var $selectedImg=$(".redactor_thumb_wrapper.checked img").eq(0);if($selectedImg.length>0){var loadImg='<p><img src="'+$selectedImg.attr("src")+'" /></p>';context.dnnImageInsert(loadImg,!0)}}),this.dnnLoadImages("",-1)}else $("#redactor-modal-tab-2").remove();this.opts.imageUpload||this.opts.s3?(this.isMobile()||this.isIPad()||this.opts.s3!==!1||$("#redactor_file").length&&this.draguploadInit("#redactor_file",{url:this.opts.imageUpload,uploadFields:this.opts.uploadFields,success:$.proxy(this.dnnImageCallback,this),error:$.proxy(function(obj,json){this.callback("imageUploadError",json)},this),uploadParam:this.opts.imageUploadParam}),this.opts.s3===!1?this.dnnUploadInit("redactor_file",{auto:!0,url:this.opts.imageUpload,success:$.proxy(this.dnnImageCallback,this),error:$.proxy(function(obj,json){this.callback("imageUploadError",json)},this)}):$("#redactor_file").on("change.redactor",$.proxy(this.s3handleFileSelect,this))):($(".redactor_tab").hide(),this.opts.imageGetJson?($("#redactor-tab-control-1").remove(),$("#redactor-tab-control-2").addClass("redactor_tabs_act leftside"),$(".redactor_modal_action_btn").hide().eq(1).show(),$("#redactor_tab2").show()):($("#redactor_tabs").remove(),$("#redactor_tab3").show(),$(".redactor_modal_action_btn").hide().eq(2).show())),this.opts.imageTabLink||!this.opts.imageUpload&&!this.opts.imageGetJson||$("#redactor-tab-control-3").hide(),$("#redactor_upload_btn").click($.proxy(this.dnnImageCallbackLink,this)),this.opts.imageUpload||this.opts.imageGetJson||setTimeout(function(){$("#redactor_file_link").focus()},200),$("#redactor_file_link").on("propertychange change click keyup input paste",function(e){$(this).data("oldvar")&&$(this).data("oldvar")==$(this).val()||(context._previewFromUrlHandler&&clearTimeout(context._previewFromUrlHandler),context._previewFromUrlHandler=setTimeout($.proxy(context.dnnPreviewFromUrl,context),500))}),$("#redactor_modal").addClass("redactor_blockBlur")},this);this.dnnModalInit(this.opts.curLang.image,this.dnnImageEditText(),610,callback)},dnnLoadImages:function(keyword,folderId,callback){var context=this,loadRecent=!1;"-1"==folderId&&(""!==this.dnnGetUploadPath()&&(folderId=this.dnnGetUploadPath()),loadRecent=!0);var permission="undefined"!=typeof redactorDropDownOptions?redactorDropDownOptions.services.parameters.permission:"";$.getJSON(this.opts.imageGetJson,{keyword:keyword,folderId:folderId,loadRecent:loadRecent,permission:permission},function(data){$("#redactor_image_box").empty(),$(".redactor_upload_btn_2").prop("disabled",!0),$.each(data,function(key,val){if("switch"==val.type){var item={key:val.id.toString(),value:val.title};context._folderPicker.selectedItem(item)}else{var thumbtitle="";"undefined"!=typeof val.title&&(thumbtitle=val.title);var img=$('<span class="redactor_thumb_wrapper"><span class="redactor_thumb_holder"><img src="'+val.thumb+'" class="redactorfolder" rel="'+val.image+'" title="'+thumbtitle+'" /><span class="active-state"></span></span><p>'+thumbtitle.substring(0,20)+"</p></span>");$("#redactor_image_box").append(img),"file"==val.type?$(img).click(function(){$(".redactor_thumb_wrapper").removeClass("checked"),$(this).addClass("checked"),$(".redactor_upload_btn_2").prop("disabled",!1)}):"folder"==val.type&&$(img).dblclick(function(e){var item={key:val.id.toString(),value:val.title};"undefined"!=typeof context._folderPicker&&(context._folderPicker.selectedItem(item),dnn.setVar(context._folderPicker.id()+"_expandPath",val.path),context.dnnLoadImages($("#redactor_search_file").val(),val.id)),e.preventDefault()})}}),"function"==typeof callback&&callback.call(context)})},dnnImageThumbClick:function(e){var img='<img id="image-marker" src="'+$(e.target).attr("rel")+'" alt="'+$(e.target).attr("title")+'" />',parent=this.getParent();this.opts.paragraphy&&0===$(parent).closest("li").size()&&(img="<p>"+img+"</p>"),this.dnnImageInsert(img,!0)},dnnImageCallbackLink:function(){var val=$("#redactor_file_link").val();if(""!==val){var data='<img id="image-marker" src="'+val+'" />';this.opts.linebreaks===!1&&(data="<p>"+data+"</p>"),this.dnnImageInsert(data,!0)}else this.modalClose()},dnnImageCallback:function(data){this.dnnImageInsert(data)},dnnImageInsert:function(json,link){var html;if(!this._isworking){if(this._isworking=!0,json.hasOwnProperty("message"))return html="<p>"+json.message+"</p>",this.insertNode($(html)),this.sync(),void this.dnnModalClose();if(this.selectionRestore(),json!==!1){if(html="",link!==!0){html='<img id="image-marker" src="'+json.filelink+'" />';var parent=this.getParent();this.opts.paragraphy&&0===$(parent).closest("li").size()&&(html="<p>"+html+"</p>")}else html=json;this.insertNode($(html));var image=$(this.$editor.find("img#image-marker"));image.length?image.removeAttr("id"):image=!1,this.sync(),link!==!0&&this.callback("imageUpload",image,json)}this.dnnModalClose(),this.observeImages(),this._isworking=!1}},dnnPreviewFromUrl:function(){var redactorModalInner,fakeloader,progress,$urlElement=$("#redactor_file_link"),url=$urlElement.val(),$insertButton=$("#redactor_upload_btn"),$previewArea=$("#redactor_tab3 .preview-main"),$previewImg=$previewArea.find("img"),$previewName=$previewArea.find(".preview-name");return $urlElement.data("oldvar",url),""===url?($insertButton.prop("disabled","disabled"),void $previewArea.hide()):($previewImg.data("loadEventBinded")||(redactorModalInner=$("#redactor_modal_inner"),redactorModalInner.prepend('<div class="fakeloader"><div class="progress"></div><div>'),fakeloader=redactorModalInner.find(".fakeloader:first"),progress=fakeloader.find(".progress:first"),progress.animate({width:"98%"},this.FAKE_PROGRESS_TIME),$previewImg.on("load",function(){$previewArea.show(),$urlElement.removeClass("error");var name=$previewImg.attr("src").replace("\\","/").split("/").pop().split("?")[0];$previewName.html(name),$insertButton.prop("disabled",""),progress.stop(!0,!0).css("width","100%"),fakeloader.fadeOut()}).on("error",function(){$previewArea.hide(),$urlElement.addClass("error"),$insertButton.prop("disabled","disabled"),progress.stop(!0,!0).css("width","100%"),fakeloader.fadeOut()}),$previewImg.data("loadEventBinded",!0)),void $previewImg.attr("src",url))},imageInsert:function(json,link){if(this.selectionRestore(),json!==!1){var html="";if(link!==!0){html='<img id="image-marker" src="'+json.filelink+'" />';var parent=this.getParent();this.opts.paragraphy&&0===$(parent).closest("li").size()&&(html="<p>"+html+"</p>")}else html=json;this.execCommand("inserthtml",html,!1);var image=$(this.$editor.find("img#image-marker"));image.length?image.removeAttr("id"):image=!1,this.sync(),link!==!0&&this.callback("imageUpload",image,json)}this.dnnModalClose(),this.observeImages()},dnnModalInit:function(title,content,width,callback){return isCustomImage=!0,this.modalSetOverlay(),this.$redactorModal=$("#redactor_modal"),this.$redactorModal.length||(this.$redactorModal=$('<div id="redactor_modal" style="display: none;" />'),this.$redactorModal.append($('<div id="redactor_modal_close">&times;</div>')),this.$redactorModal.append($('<header id="redactor_modal_header" />')),this.$redactorModal.append($('<div id="redactor_modal_inner" />')),$("body").append(this.$redactorModal)),$("#redactor_modal_close").on("click",$.proxy(this.dnnModalClose,this)),$("#redactor_modal_overlay").off("click"),$(document).keyup($.proxy(this.dnnModalCloseHandler,this)),this.$editor.keyup($.proxy(this.dnnModalCloseHandler,this)),this.modalSetContent(content),this.modalSetTitle(title),this.modalSetDraggable(),this.dnnModalLoadTabs(),this.modalOnCloseButton(),this.modalSetButtonsWidth(width),this.saveModalScroll=this.document.body.scrollTop,this.opts.autoresize===!1&&(this.saveModalScroll=this.$editor.scrollTop()),this.isMobile()===!1?this.modalShowOnDesktop(width):this.modalShowOnMobile(),"function"==typeof callback&&callback(),setTimeout($.proxy(function(){this.callback("modalOpened",this.$redactorModal)},this),11),$(document).off("focusin.modal"),window.jQuery&&window.jQuery.ui.dialog&&$(document).unbind("focusin.dialog"),this.$redactorModal.find("input[type=text]").on("keypress",$.proxy(function(e){13===e.which&&(this.$redactorModal.find(".redactor_modal_action_btn").click(),e.preventDefault())},this)),$("input#redactor_file").on("change",function(){imageUploaded=1e3}),this.$redactorModal},dnnModalCloseHandler:function(e){if(e.keyCode===this.keyCode.ESC)return this.modalClose(),isCustomImage=!1,!1},dnnModalClose:function(){return this.xhr&&(this.xhr.abort(),this.dnnUploadAsyncAborted()),$("#redactor_modal_close").off("click",this.dnnModalClose),$("#redactor_modal").fadeOut("fast",$.proxy(function(){var redactorModalInner=$("#redactor_modal_inner");this.modalcontent!==!1&&(this.modalcontent.html(redactorModalInner.html()),this.modalcontent=!1,isCustomImage=!1),redactorModalInner.html(""),this.opts.modalOverlay&&($("#redactor_modal_overlay").hide().off("click",this.dnnModalClose),isCustomImage=!1),$(document).unbind("keyup",this.hdlModalClose),this.$editor.unbind("keyup",this.hdlModalClose),isCustomImage=!1,this.selectionRestore(),this.opts.autoresize&&this.saveModalScroll?$(this.document.body).scrollTop(this.saveModalScroll):this.opts.autoresize===!1&&this.saveModalScroll&&this.$editor.scrollTop(this.saveModalScroll),this.callback("modalClosed")},this)),this.isMobile()===!1&&$(document.body).css("overflow",this.modalSaveBodyOveflow?this.modalSaveBodyOveflow:"visible"),!1},dnnModalLoadTabs:function(){var $redactor_tabs=$("#redactor_tabs");if(!$redactor_tabs.length)return!1;var that=this;$redactor_tabs.find("> a").each(function(i,s){i++,$(s).on("click",function(e){if(e.preventDefault(),$(".redactor_modal_action_btn").hide(),$(".redactor_upload_btn_"+i).show(),$redactor_tabs.find("a").removeClass("redactor_tabs_act"),$(this).addClass("redactor_tabs_act"),$(".redactor_tab").hide(),$("#redactor_tab"+i).show(),$("#redactor_tab_selected").val(i),that.isMobile()===!1){var height=that.$redactorModal.outerHeight();that.$redactorModal.css("margin-top","-"+(height+10)/2+"px")}})})},dnnUploadInit:function(el,options){this.dnnUploadOptions={url:!1,success:!1,error:!1,start:!1,trigger:!1,auto:!1,input:!1},$.extend(this.dnnUploadOptions,options);var $el=$("#"+el);$el.length&&"INPUT"===$el[0].tagName?(this.dnnUploadOptions.input=$el,this.el=$($el[0].form)):this.el=$el,this.element_action=this.el.attr("action");var $dropbox=this.el.find(".redactor_dropareabox");$dropbox.length>0&&(this.el.find(".redactor_dropareabox").get(0).ondrop=void 0,this.el.find(".redactor_dropareabox").on("drop",$.proxy(this.dnnUploadOnDrop,this))),this.dnnUploadOptions.auto?$(this.dnnUploadOptions.input).change($.proxy(function(e){""!==this.dnnUploadOptions.input.val()&&(this.el.submit(function(e){return!1}),this.dnnUploadSubmit(e))},this)):this.dnnUploadOptions.trigger&&$("#"+this.dnnUploadOptions.trigger).click($.proxy(this.dnnUploadSubmit,this))},dnnUploadSubmit:function(e){this.dnnUploadForm(this.element,this.dnnUploadFrame())},dnnUploadFrame:function(){this.id="f"+Math.floor(99999*Math.random());var d=this.document.createElement("div"),iframe='<iframe style="display:none" id="'+this.id+'" name="'+this.id+'"></iframe>';return d.innerHTML=iframe,$(d).appendTo("body"),this.dnnUploadOptions.start&&this.dnnUploadOptions.start(),$("#"+this.id).load($.proxy(this.dnnUploadLoaded,this)),this.id},dnnUploadForm:function(f,name){if(this.dnnUploadOptions.input){if("undefined"!=typeof FormData&&"undefined"!=typeof XMLHttpRequest&&"undefined"!=typeof FileReader)return void this.dnnUploadAsync();var formId="redactorUploadForm"+this.id,fileId="redactorUploadFile"+this.id,extension=this.dnnUploadOptions.input.val().split(".").pop().toLowerCase();if("jpg|jpe|bmp|gif|png|jpeg|ico".indexOf(extension)==-1)return void alert(invalidFileMessage);this.form=$('<form  action="'+this.dnnUploadOptions.url+'" method="POST" target="'+name+'" name="'+formId+'" id="'+formId+'" enctype="multipart/form-data" />'),this.opts.uploadFields!==!1&&"object"==typeof this.opts.uploadFields&&$.each(this.opts.uploadFields,$.proxy(function(k,v){v&&0===v.toString().indexOf("#")&&(v=$(v).val());var hidden=$("<input/>",{type:"hidden",name:k,value:v});$(this.form).append(hidden)},this));var oldElement=this.dnnUploadOptions.input,newElement=$(oldElement).clone();$(oldElement).attr("id",fileId).before(newElement).appendTo(this.form);var uploadPath=this.dnnGetUploadPath();$('<input type="text" name="uploadPath" id="uploadPath" />').val(uploadPath).appendTo(this.form),$(this.form).css("position","absolute").css("top","-2000px").css("left","-2000px").appendTo("body"),this.form.submit()}else f.attr("target",name).attr("method","POST").attr("enctype","multipart/form-data").attr("action",this.dnnUploadOptions.url),this.element.submit()},dnnUploadOnDrop:function(e){e.preventDefault(),e.stopPropagation(),this.dnnUploadFileByAjax(e.originalEvent.dataTransfer.files[0]),$(".redactor_drag_drop_text").hide()},dnnUploadAsync:function(){this.dnnUploadFileByAjax(this.dnnUploadOptions.input.get(0).files[0])},dnnUploadFileByAjax:function(file){this.showUploadStatus(file);var $status=$("#redactor-modal-image-upload-status"),extension=file.name.split(".").pop().toLowerCase();if("jpg|jpe|bmp|gif|png|jpeg|ico".indexOf(extension)==-1)return this.dnnUploadAsyncFailed(this.opts.curLang.invalidFileMessage),void $status.find("img").attr("src","");if(file.size>this.opts.maxFileSize)return this.dnnUploadAsyncFailed(this.opts.curLang.exceedLimit),void $status.find("img").attr("src","");var formData=new FormData;formData.append("file",file),formData.append("uploadPath",this.dnnGetUploadPath()),this.xhr=new XMLHttpRequest,this.xhr.upload.addEventListener("progress",$.proxy(this.uploadProgressChanged,this),!1),this.xhr.addEventListener("load",$.proxy(this.dnnUploadAsyncLoaded,this),!1),this.xhr.addEventListener("error",$.proxy(this.dnnUploadAsyncFailed,this),!1),this.xhr.addEventListener("abort",$.proxy(this.dnnUploadAsyncAborted,this),!1),this.xhr.open("POST",this.dnnUploadOptions.url),this.xhr.send(formData)},dnnGetUploadPath:function(){var moduleId=this.opts.dnnModuleId;if("undefined"==typeof moduleId||"undefined"==typeof window.dnn||"undefined"==typeof window.dnn.getVar)return"";var path=window.dnn.getVar("redactor_uploadpath_"+moduleId);return path||""},showUploadStatus:function(file){var context=this,$status=$("#redactor-modal-image-upload-status");$status.show(),$status.find(".upload-status-progress").removeClass("failed abort complete"),$status.find(".upload-status-progress .bar span").width(0),$status.find(".upload-status-message").html(""),$status.find(".upload-status-name").html(file.name),$status.find("img").attr("src",URL.createObjectURL(file)),this.cancelUploadAsyncHandler=$.proxy(this.cancelUploadAsync,this),context.$redactorModal.find(".redactor_modal_btn").hide(),context.$redactorModal.find(".redactor_modal_btn.redactor_btn_modal_close").show().click(this.cancelUploadAsyncHandler).each(function(){var events=$._data(this,"events").click,fisrt=events.pop();events.splice(0,0,fisrt)}),$status.find(".btn-cancel").click(this.cancelUploadAsyncHandler)},hideUploadStatus:function(){var $status=$("#redactor-modal-image-upload-status");$status.hide(),$status.find(".btn-cancel").off("click"),this.$redactorModal.find("#redactor_upload_btn1").show(),this.$redactorModal.find(".redactor_modal_btn.redactor_btn_modal_close").off("click",this.cancelUploadAsyncHandler)},uploadProgressChanged:function(e){var percentValue=Math.round(100*e.loaded/e.total),$status=$("#redactor-modal-image-upload-status");$status.find(".upload-status-progress .bar span").width(percentValue+"%")},dnnUploadLoaded:function(){var d,i=$("#"+this.id)[0];if(d=i.contentDocument?i.contentDocument:i.contentWindow?i.contentWindow.document:window.frames[this.id].document,this.dnnUploadOptions.success)if("undefined"!=typeof d){var rawString=d.body.innerHTML;if(!rawString)return;var jsonString=rawString.match(/\{(.|\n)*\}/)[0];jsonString=jsonString.replace(/^\[/,""),jsonString=jsonString.replace(/\]$/,"");var json=$.parseJSON(jsonString);if(this.dnnUploadOptions.input&&this.dnnUploadOptions.input.val(""),this._folderPicker){if("-1"!=this._folderPicker.selectedItem().key){var item={key:"-1",value:this.opts.curLang.recentUploads};this._folderPicker.selectedItem(item)}$("#redactor_search_file").val(""),this.dnnLoadImages("",-1,function(){$("#redactor_image_box").find(".redactor_thumb_wrapper:eq(0)").click()}),$("#redactor_tabs").find("> a").eq(1).click()}else"undefined"==typeof json.error?this.dnnUploadOptions.success(json):(this.dnnUploadOptions.error(this,json),this.modalClose())}else this.modalClose(),alert("Upload failed!");this.el.attr("action",this.element_action),this.el.attr("target","")},dnnUploadAsyncLoaded:function(){if(200!=this.xhr.status)return void this.dnnUploadAsyncFailed();var $status=$("#redactor-modal-image-upload-status");if($status.find(".upload-status-progress").addClass("complete"),this.dnnUploadOptions.success){var rawString=this.xhr.response;if(!rawString)return;var jsonString=rawString.match(/\{(.|\n)*\}/)[0];jsonString=jsonString.replace(/^\[/,""),jsonString=jsonString.replace(/\]$/,"");var json=$.parseJSON(jsonString);if(this.xhr=null,this.dnnUploadOptions.input&&this.dnnUploadOptions.input.val(""),this.hideUploadStatus(),this._folderPicker){if("-1"!=this._folderPicker.selectedItem().key){var item={key:"-1",value:this.opts.curLang.recentUploads};this._folderPicker.selectedItem(item)}$("#redactor_search_file").val(""),this.dnnLoadImages("",-1,function(){$("#redactor_image_box").find(".redactor_thumb_wrapper:eq(0)").click()}),$("#redactor_tabs").find("> a").eq(1).click()}else"undefined"==typeof json.error?this.dnnUploadOptions.success(json):(this.dnnUploadOptions.error(this,json),this.modalClose())}this.el.attr("action",this.element_action),this.el.attr("target","")},dnnUploadAsyncFailed:function(message){var $status=$("#redactor-modal-image-upload-status");if($status.find(".upload-status-progress").addClass("failed"),"undefined"==typeof message&&this.xhr)switch(this.xhr.status){case 404:message=this.opts.curLang.exceedLimit;break;case 500:var content=this.xhr.response;message=0===content.indexOf("{")?eval("("+content+")").message:content}$status.find(".upload-status-message").html(message),this.dnnUploadOptions.input&&this.dnnUploadOptions.input.val("")},dnnUploadAsyncAborted:function(){var $status=$("#redactor-modal-image-upload-status");$status.find(".upload-status-progress").addClass("abort")},cancelUploadAsync:function(e){this.xhr&&(this.xhr.abort(),this.xhr=null,this.dnnUploadAsyncAborted(),this.dnnUploadOptions.input&&this.dnnUploadOptions.input.val("")),this.hideUploadStatus(),e.stopImmediatePropagation(),$(".redactor_drag_drop_text").show()},dnnLinkObserver:function(e){var $link=$(e.target);if(0!==$link.size()&&"A"===$link[0].tagName){var pos=$link.offset();if(this.opts.iframe){var posFrame=this.$frame.offset();pos.top=posFrame.top+(pos.top-$(this.document).scrollTop()),pos.left+=posFrame.left}var tooltip=$('<span class="redactor-link-tooltip"></span>'),href=$link.attr("href");void 0===href&&(href=""),href.length>24&&(href=href.substring(0,24)+"...");var aLink=$('<a href="'+$link.attr("href")+'" target="_blank">'+href+"</a>").on("click",$.proxy(function(e){this.linkObserverTooltipClose(!1)},this)),aEdit=$('<a href="#">'+this.opts.curLang.edit+"</a>").on("click",$.proxy(function(e){e.preventDefault(),this.linkShow(),this.linkObserverTooltipClose(!1)},this)),aUnlink=$('<a href="#">'+this.opts.curLang.unlink+"</a>").on("click",$.proxy(function(e){e.preventDefault(),this.execCommand("unlink"),this.linkObserverTooltipClose(!1)},this));tooltip.append(aLink),tooltip.append(" | "),tooltip.append(aEdit),tooltip.append(" | "),tooltip.append(aUnlink),tooltip.css({top:pos.top+20+"px",left:pos.left+"px"}),$(".redactor-link-tooltip").remove(),$("body").append(tooltip)}}};