
window.dnn=dnn||{};window.dnn.personalizedTabs=dnn.personalizedTabs||{};(function IIFE(){var EditBarPersonalizedTabManagerClass;EditBarPersonalizedTabManagerClass=(function IIFE(){'use strict';var HTML_PATH='Assests/Html/EditBarPersonalizedTabOptions.html';var HTML_BINDING_ID='editBarPersonalizedTabOptions';var ELEMENTS_ID_TO_BE_DELETED=["editBarAddModuleButton","editBarSettingButton"];var PREFIX_MODULE_ACTIONS_ID="moduleAction";var DNN_DRAG_HINT_CLASS="dnnDragHint";var DNN_MODULE_CLASS="DnnModule";var DNN_HTML_MODULE_CLASS="DnnModule-DNN_HTML";var DNN_CONTENTLAYOUT_MODULE_CLASS="DnnModule-ContentLayout";var DNN_QUICKADDMODULE="dnnQuickAddModuleManager";var _viewModel;var _templateLoader;var _editBarContentPersonalizationCommonManager;var resx;var dnnEditBarActiveCallback,iniListeners,deleteNotAllowedElements,deleteEditBarButtons,deleteModuleActions,deleteDragHint,deleteQuickAddModule,putMaskOverNonHtmlModules,putMaskOverNonHtmlModule,createViewModel,disablePrivatePageIconButton,resxCallback200;EditBarPersonalizedTabManager.class='EditBarPersonalizedTabManager';EditBarPersonalizedTabManager.type='Class';_viewModel={};function EditBarPersonalizedTabManager(){_templateLoader=new window.dnn.personalizedTabs.TemplateLoader();iniListeners();}
iniListeners=function(){$(document).on("dnnEditBarActive",function(event,data){dnnEditBarActiveCallback();});};createViewModel=function(){_viewModel={personalizedPageName:dnn.getVar('dnn_content_personalization_personalized_page_name'),resx:{labels:{personalizedPage:resx.PersonalizedPage,onlyHtmlContentCanBeEdited:resx.OnlyHtmlContentCanBeEdited}}};};deleteEditBarButtons=function(){ELEMENTS_ID_TO_BE_DELETED.forEach(function(element){$('#'+element).remove();});};deleteModuleActions=function(){$(String.format("[id^={0}]",PREFIX_MODULE_ACTIONS_ID)).remove();};deleteDragHint=function(){$(String.format(".{0}",DNN_DRAG_HINT_CLASS)).remove();};deleteQuickAddModule=function(){$(String.format(".{0}",DNN_QUICKADDMODULE)).remove();};deleteNotAllowedElements=function(){deleteEditBarButtons();deleteModuleActions();deleteDragHint();deleteQuickAddModule();};disablePrivatePageIconButton=function(){var $button=$('#edit-bar .private-page');$button.off('click');$button.css('cursor','auto');};putMaskOverNonHtmlModule=function($module){var children=$module.children();var styles='background-color: #6F6F6F; opacity: .5; filter: Alpha(Opacity=50); z-index:990;';var $mask=$('<div class="dnnPersonalizedPageMask">').attr('style',styles+'width: 100%;height: 100%;position: absolute;left: 0px;top: 0px;');var $div=$('<div>').attr('style','position: relative');$div.append(children);$div.append($mask);$module.empty();$module.append($div);};putMaskOverNonHtmlModules=function(){var nonHtmlModules=$(String.format(".{0}",DNN_MODULE_CLASS)).not(String.format(".{0}, .{1}",DNN_HTML_MODULE_CLASS,DNN_CONTENTLAYOUT_MODULE_CLASS));$.each(nonHtmlModules,function(key,nonHtmlModule){putMaskOverNonHtmlModule($(nonHtmlModule));});};var resxCallback200=function(data){resx=data.localization;createViewModel();deleteNotAllowedElements();disablePrivatePageIconButton();putMaskOverNonHtmlModules();var toInject=[{extensionPointId:dnn.getVar('dnn_content_personalization_editBarOptionsExtensionPoint'),path:dnn.getVar('dnn_content_personalization_resourceroot')+HTML_PATH,viewModel:_viewModel,viewModelBindingId:HTML_BINDING_ID,callback:function(){$.dnnNotif({dialogClass:'noTittle',text:_viewModel.resx.labels.onlyHtmlContentCanBeEdited,styleBlue:true,height:50});}}];_editBarContentPersonalizationCommonManager=new window.dnn.personalizedTabs.EditBarContentPersonalizationCommonManager(toInject);};dnnEditBarActiveCallback=function(){var localizationOptions={service:'ContentPersonalization',controller:'Localization',resxName:'EditBarPersonalizedTabResourcesSettingsResx',resourceSettings:{local:{culture:dnn.getVar('cem_EditBarPersonalizedTabResourcesSettings_resx_culture'),resxTimeStamp:dnn.getVar('cem_EditBarPersonalizedTabResourcesSettings_resx_timestamp')}},resources:{method:'GetEditBarPersonalizedTabTable',paramName:null,callback200:resxCallback200,callbackError:null}};new dnn.utils.Localization(localizationOptions);};return EditBarPersonalizedTabManager;})();window.dnn.personalizedTabs.EditBarPersonalizedTabManager=EditBarPersonalizedTabManagerClass;}).call(this);$(window).load(function(){var editBarPersonalizedTabManager=new window.dnn.personalizedTabs.EditBarPersonalizedTabManager();});