
﻿
window.dnn=dnn||{};window.dnn.personalizedTabs=dnn.personalizedTabs||{};window.dnn.personalizedTabs.rules=dnn.personalizedTabs.rules||{};window.dnn.personalizedTabs.rules.userProfile=dnn.personalizedTabs.rules.userProfile||{};(function IIFE(){var CollectionTypeViewModelControllerClass;CollectionTypeViewModelControllerClass=(function IIFE(){'use strict';CollectionTypeViewModelController.class='CollectionTypeViewModelController';CollectionTypeViewModelController.type='Class';var _service;var getService,getServiceUrl,tokenInputResultsFormatter;function CollectionTypeViewModelController(){}
getService=function(){if(!_service){_service=$.dnnSF();}
return _service;};getServiceUrl=function(service,controller){return getService().getServiceRoot(service)+controller+'/';};tokenInputResultsFormatter=function(item){return"<li class='user'><span>"+item.name+"</span></li>";};CollectionTypeViewModelController.getViewModel=function(propertyId,ruleId,_resx){var _viewModel={url:ko.observable(getServiceUrl("ContentPersonalization","UserProfile")+"SearchCollectionValues?propertyId="+propertyId),tokens:ko.observableArray([]).extend({required:true}),tokenInputResultsFormatter:tokenInputResultsFormatter,resx:_resx};return _viewModel;};CollectionTypeViewModelController.getViewModelValidation=function(viewModel){return{tokens:viewModel.tokens}};CollectionTypeViewModelController.fillViewModel=function(propertyId,ruleId,_resx,matchData){var viewModel=CollectionTypeViewModelController.getViewModel(propertyId,ruleId,_resx);try{var collectionToken=JSON.parse(matchData.PropertyInfo.MatchValue);if(collectionToken&&collectionToken.Id&&collectionToken.Name){var option={};option.id=collectionToken.Id;option.name=collectionToken.Name;viewModel.tokens.push(option);}
return viewModel;}catch(ex){return viewModel;}};CollectionTypeViewModelController.fillData=function(matchValue){var option=matchValue.tokens()[0];var collectionToken={};collectionToken.Id=option.id;collectionToken.Name=option.name;return JSON.stringify(collectionToken);};return CollectionTypeViewModelController;})();window.dnn.personalizedTabs.rules.userProfile.CollectionTypeViewModelController=CollectionTypeViewModelControllerClass;}).call(this);